<div class="page" style="background-color: #f5eddc; padding: 20px; border-radius: 10px;">
  <style>
    .highlightedTreeNode {
      background-color: rgba(255, 165, 0, 0.4) !important;
      border: 2px solid orange !important;
      padding: 4px 8px !important;
      margin: 2px 0 !important;
      border-radius: 6px !important;
      box-shadow: 0 2px 4px rgba(255, 165, 0, 0.3) !important;
    }
    
    /* Sticky metadata panel */
    .sticky-metadata-container {
      position: sticky;
      top: 80px;  /* Increased from 20px to account for navbar */
      max-height: calc(100vh - 100px);  /* Adjusted to match the new top offset */
      overflow-y: auto;
      background-color: white;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.05);
      padding: 15px;
    }
    
    /* Smooth scrollbar for metadata panel */
    .sticky-metadata-container::-webkit-scrollbar {
      width: 8px;
    }
    
    .sticky-metadata-container::-webkit-scrollbar-track {
      background: #f1f1f1;
      border-radius: 4px;
    }
    
    .sticky-metadata-container::-webkit-scrollbar-thumb {
      background: #888;
      border-radius: 4px;
    }
    
    .sticky-metadata-container::-webkit-scrollbar-thumb:hover {
      background: #555;
    }
    
    .siblingExpandButton {
      background-color: #f8f9fa;
      border: 1px solid #dee2e6;
      border-radius: 4px;
      padding: 4px 8px;
      margin: 2px 0;
      cursor: pointer;
      font-size: 0.85em;
      color: #6c757d;
      transition: all 0.2s ease;
    }
    
    .siblingExpandButton:hover {
      background-color: #e9ecef;
      border-color: #adb5bd;
      color: #495057;
    }
    
    /* Styles for related nodes icon */
    .tree-node-container {
      position: relative;
      display: inline-flex;
      align-items: center;
      width: 100%;
    }
    
    .related-nodes-icon-btn {
      transition: all 0.2s ease;
    }
    
    .related-nodes-icon-btn:hover {
      background-color: #f0f0f0 !important;
      border-color: #999 !important;
      color: #333 !important;
    }
    
    .related-nodes-dropdown {
      animation: fadeIn 0.2s ease;
      /* Ensure dropdown is not constrained by parent overflow */
      position: fixed !important;
    }
    
    /* Ensure tree containers don't hide dropdowns */
    .tree-view_children {
      overflow: visible !important;
    }
    
    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(-5px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    /* Metadata display styles */
    .metadata-section {
      background-color: white;
      border-radius: 8px;
      padding: 15px;
      margin-bottom: 15px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.05);
    }
    
    .metadata-section h4 {
      color: #2c3e50;
      border-bottom: 2px solid #3498db;
      padding-bottom: 8px;
      margin-bottom: 15px;
      font-size: 16px;
    }
    
    .metadata-field {
      margin-bottom: 10px;
      font-size: 14px;
    }
    
    .metadata-label {
      font-weight: bold;
      color: #555;
      display: inline-block;
      min-width: 150px;
    }
    
    .metadata-value {
      color: #333;
    }
    
    .metadata-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 10px;
      font-size: 13px;
    }
    
    .metadata-table th {
      background-color: #f8f9fa;
      border: 1px solid #dee2e6;
      padding: 8px;
      text-align: left;
      font-weight: 600;
      color: #495057;
    }
    
    .metadata-table td {
      border: 1px solid #dee2e6;
      padding: 8px;
      color: #333;
    }
    
    .metadata-table tr:nth-child(even) {
      background-color: #f8f9fa;
    }
    
    .technical-description {
      background-color: #f0f8ff;
      border-left: 4px solid #3498db;
      padding: 10px;
      margin: 10px 0;
      font-style: italic;
      color: #555;
      font-size: 13px;
    }
    
    .loading-metadata {
      text-align: center;
      padding: 20px;
      color: #666;
    }
    
    .no-metadata {
      color: #999;
      font-style: italic;
      padding: 10px;
      background-color: #f8f9fa;
      border-radius: 4px;
      text-align: center;
    }
  </style>
  
  <h1>Evangelisti Archive Tree - Advanced (Lazy Loading with Search)</h1>
  
  <p>This demonstrates the SemanticTreeAdvanced component with lazy loading and search functionality.</p>
  
  <!-- Two-column layout -->
  <div style="display: flex; gap: 30px; margin-bottom: 20px;">
    <!-- Left column: Semantic Tree Advanced -->
    <div style="flex: 1; min-width: 0; background-color: white; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.05); padding: 15px;">
      <h3 style="color: #2c3e50; border-bottom: 2px solid #3498db; padding-bottom: 8px; margin-bottom: 15px;">Archive structure (Lazy Loading with Search)</h3>
      <semantic-tree-advanced 
        id="evangelisti-tree-advanced"
        search-placeholder="Search archive nodes..."
        search-query="
          SELECT DISTINCT ?node WHERE {
            GRAPH <http://ficlit.unibo.it/ArchivioEvangelisti/structure/RS1_RS1> {
              ?node rdfs:label ?label .
              FILTER(CONTAINS(LCASE(?label), LCASE(&quot;$__searchText__&quot;)))
            }
          }
        "
        related-node-criteria='[
          {
            "label": "Same Creation Date",
            "icon": "fa fa-calendar",
            "query": "PREFIX rico: <https://www.ica.org/standards/RiC/ontology#> SELECT DISTINCT ?node WHERE { <$__nodeIri__> rico:hasCreationDate ?sourceDate . ?sourceDate rico:normalizedDateValue ?sourceDateValue . ?node rico:hasCreationDate ?targetDate . ?targetDate rico:normalizedDateValue ?targetDateValue . FILTER(?targetDateValue = ?sourceDateValue && ?node != <$__nodeIri__>) }",
            "description": "Find all records with the same creation date"
          },
          {
            "label": "Same Modification Date",
            "icon": "fa fa-calendar-check-o",
            "query": "PREFIX rico: <https://www.ica.org/standards/RiC/ontology#> SELECT DISTINCT ?node WHERE { <$__nodeIri__> rico:hasModificationDate ?sourceDate . ?sourceDate rico:normalizedDateValue ?sourceDateValue . ?node rico:hasModificationDate ?targetDate . ?targetDate rico:normalizedDateValue ?targetDateValue . FILTER(?targetDateValue = ?sourceDateValue && ?node != <$__nodeIri__>) }",
            "description": "Find all records with the same modification date"
          },
          {
            "label": "Same File Type",
            "icon": "fa fa-file-o",
            "query": "PREFIX rico: <https://www.ica.org/standards/RiC/ontology#> SELECT DISTINCT ?node WHERE { <$__nodeIri__> rico:hasOrHadInstantiation ?sourceInst . ?sourceInst rico:type ?sourceType . ?node rico:hasOrHadInstantiation ?targetInst . ?targetInst rico:type ?targetType . FILTER(?targetType = ?sourceType && ?node != <$__nodeIri__>) }",
            "description": "Find all records with the same file type"
          },
          {
            "label": "Direct Children",
            "icon": "fa fa-level-down",
            "query": "SELECT DISTINCT ?node WHERE { GRAPH <http://ficlit.unibo.it/ArchivioEvangelisti/structure/RS1_RS1> { <$__nodeIri__> <https://www.ica.org/standards/RiC/ontology#includesOrIncluded> ?node } }",
            "description": "Find only direct child nodes"
          },
          {
            "label": "Path to Root",
            "icon": "fa fa-arrow-up",
            "query": "SELECT DISTINCT ?node WHERE { GRAPH <http://ficlit.unibo.it/ArchivioEvangelisti/structure/RS1_RS1> { <$__nodeIri__> (<https://www.ica.org/standards/RiC/ontology#isOrWasPartOf>)+ ?node } }",
            "description": "Find all ancestor nodes up to the root"
          }
        ]'
        query="
          SELECT DISTINCT ?parent ?node ?label ?title ?hasChildren (COUNT(DISTINCT ?child) as ?childCount) WHERE {
            GRAPH <http://ficlit.unibo.it/ArchivioEvangelisti/structure/RS1_RS1> {
              ?parent a <https://www.ica.org/standards/RiC/ontology#RecordSet> .
              ?parent <https://www.ica.org/standards/RiC/ontology#includesOrIncluded> ?node .
              ?parent <https://www.ica.org/standards/RiC/ontology#hasOrHadInstantiation> ?pInst .
              ?pInst <http://example.org/rico-bodi#hierarchyDepth> ?depth .
              OPTIONAL { ?parent rdfs:label ?label }
              OPTIONAL { ?node rdfs:label ?title }
              OPTIONAL { ?node <https://www.ica.org/standards/RiC/ontology#includesOrIncluded> ?child . }
              BIND(EXISTS { ?node <https://www.ica.org/standards/RiC/ontology#includesOrIncluded> ?anyChild . } AS ?hasChildren)
              FILTER(xsd:integer(?depth) < 1)
            }
          } GROUP BY ?parent ?node ?label ?title ?hasChildren
        "
        expand-query="
          SELECT DISTINCT ?parent ?node ?label ?title ?hasChildren (COUNT(DISTINCT ?child) as ?childCount) WHERE {
            GRAPH <http://ficlit.unibo.it/ArchivioEvangelisti/structure/RS1_RS1> {
              <{{clickedNode}}> <https://www.ica.org/standards/RiC/ontology#includesOrIncluded> ?node .
              BIND(<{{clickedNode}}> as ?parent)
              OPTIONAL { ?parent rdfs:label ?label }
              OPTIONAL { ?node rdfs:label ?title }
              OPTIONAL { ?node <https://www.ica.org/standards/RiC/ontology#includesOrIncluded> ?child . }
              BIND(EXISTS { ?node <https://www.ica.org/standards/RiC/ontology#includesOrIncluded> ?anyChild . } AS ?hasChildren)
            }
          } GROUP BY ?parent ?node ?label ?title ?hasChildren
        "
        path-to-root-query="
          SELECT DISTINCT ?ancestor WHERE {
            GRAPH <http://ficlit.unibo.it/ArchivioEvangelisti/structure/RS1_RS1> {
              <$__node__> (<https://www.ica.org/standards/RiC/ontology#isOrWasPartOf>)* ?ancestor .
            }
          }
        "
      roots='["http://ficlit.unibo.it/ArchivioEvangelisti/RS1_RS1"]'
      has-children-binding="hasChildren"
      enable-cache="true"
      loading-template='<i class="fa fa-spinner fa-spin" style="color: #3498db; margin-left: 8px;"></i>'
      sort-options='[
        {"label": "Title", "binding": "title", "type": "string"},
        {"label": "Node IRI", "binding": "node", "type": "string"},
        {"label": "Number of Children", "binding": "childCount", "type": "number", "defaultDirection": "desc"}
      ]'
      initial-sort='{"binding": "title", "direction": "asc"}'
      show-sort-controls="true"
      tuple-template='{{> nodeTemplate}}'>
        
        <template id='nodeTemplate'>
          <div>
            {{#if (eq expandSiblings.value "true")}}
              <!-- Expand siblings button -->
              <div class="siblingExpandButton" style="background-color: #f8f9fa; border: 1px solid #dee2e6; border-radius: 4px; padding: 4px 8px; margin: 2px 0; cursor: pointer; font-size: 0.85em; color: #6c757d;">
                <i class="fa fa-plus-circle" style="margin-right: 5px;"></i>
                Expand {{hiddenCount.value}} siblings...
              </div>
            {{else}}
              <!-- Regular node -->
              <mp-event-trigger type='Component.TemplateUpdate' data='{"iri": "{{node.value}}", "hasChildren": "{{hasChildren.value}}", "childCount": "{{childCount.value}}"}' targets='["node-details-advanced"]'>
                <div class="node-content" style="cursor: pointer; padding: 5px; border-radius: 4px; transition: background-color 0.2s; margin-bottom: 3px;">
                  <div style="display: flex; align-items: center;">
                    {{#if (eq hasChildren.value "true")}}
                      <i class="fa fa-folder" style="margin-right: 8px; color: #ffc107;"></i>
                      <span style="font-size: 0.8em; color: #777; margin-right: 5px;">({{childCount.value}})</span>
                    {{else}}
                      <i class="fa fa-file-text-o" style="margin-right: 8px; color: #2196F3;"></i>
                    {{/if}}
                    
                    <div>
                      {{#if title.value}}
                        <a href="{{node.value}}" target="_blank" style="font-weight: bold; color: #333; text-decoration: none;">{{title.value}}</a>
                      {{else}}
                        <a href="{{node.value}}" target="_blank" style="font-weight: bold; color: #333; text-decoration: none;">{{node.value}}</a>
                      {{/if}}
                      <div style="font-size: 0.8em; color: #777;">{{node.value}}</div>
                    </div>
                  </div>
                </div>
              </mp-event-trigger>
            {{/if}}
          </div>
        </template>
      </semantic-tree-advanced>
    </div>
    
    <!-- Right column: Node Details with Metadata -->
    <div style="flex: 1; min-width: 0;">
      <div class="sticky-metadata-container">
        <h3 style="color: #2c3e50; border-bottom: 2px solid #3498db; padding-bottom: 8px; margin-bottom: 15px;">Node Metadata</h3>
        <mp-event-target-template-render id='node-details-advanced' template='{{> detailsTemplate}}'>
        <template id='detailsTemplate'>
          {{#if iri}}
            <!-- Fetch metadata for the selected node -->
            <semantic-query 
              query='
                PREFIX rico: <https://www.ica.org/standards/RiC/ontology#>
                PREFIX rico-bodi: <http://example.org/rico-bodi#>
                PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
                PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
                
                SELECT DISTINCT ?node ?nodeLabel ?nodeType 
                       ?title ?titleLabel
                       ?creationDate ?creationDateLabel ?creationDateNormalized
                       ?modificationDate ?modificationDateLabel ?modificationDateNormalized
                       ?instantiation ?instLabel ?instType
                       ?techDesc ?techDescValue
                       ?techMetadata ?techMetadataLabel ?techMetadataValue ?techMetadataType ?techMetadataTypeLabel
                       ?metadataSet ?metadataSetLabel
                WHERE {
                  BIND(<{{iri}}> as ?node)
                  
                  # Get node basic info
                  OPTIONAL { ?node rdfs:label ?nodeLabel }
                  OPTIONAL { ?node a ?nodeType }
                  
                  # Get title
                  OPTIONAL { 
                    ?node rico:hasOrHadTitle ?title .
                    ?title rdfs:label ?titleLabel .
                  }
                  
                  # Get creation date
                  OPTIONAL { 
                    ?node rico:hasCreationDate ?creationDate .
                    OPTIONAL { ?creationDate rico:expressedDate ?creationDateLabel }
                    OPTIONAL { ?creationDate rico:normalizedDateValue ?creationDateNormalized }
                  }
                  
                  # Get modification date
                  OPTIONAL { 
                    ?node rico:hasModificationDate ?modificationDate .
                    OPTIONAL { ?modificationDate rico:expressedDate ?modificationDateLabel }
                    OPTIONAL { ?modificationDate rico:normalizedDateValue ?modificationDateNormalized }
                  }
                  
                  # Get instantiation info
                  OPTIONAL { 
                    ?node rico:hasOrHadInstantiation ?instantiation .
                    OPTIONAL { ?instantiation rdfs:label ?instLabel }
                    OPTIONAL { ?instantiation rico:type ?instType }
                    
                    # Get technical description
                    OPTIONAL {
                      ?instantiation rico-bodi:hasTechnicalDescription ?techDesc .
                      ?techDesc rdf:value ?techDescValue .
                    }
                    
                    # Get technical metadata
                    OPTIONAL {
                      ?instantiation rico-bodi:hasTechnicalMetadata ?techMetadata .
                      ?techMetadata rdfs:label ?techMetadataLabel .
                      ?techMetadata rdf:value ?techMetadataValue .
                      OPTIONAL {
                        ?techMetadata rico-bodi:hasTechnicalMetadataType ?techMetadataType .
                        ?techMetadataType rdfs:label ?techMetadataTypeLabel .
                        OPTIONAL {
                          ?techMetadataType rico:isOrWasPartOf ?metadataSet .
                          ?metadataSet rdfs:label ?metadataSetLabel .
                        }
                      }
                    }
                  }
                }
                ORDER BY ?metadataSetLabel ?techMetadataTypeLabel
              '
              template='{{> metadataDisplay}}'
            >
              <template id='metadataDisplay'>
                {{#if bindings.length}}
                  {{#with bindings.[0]}}
                    <!-- Node Details Section -->
                    <div class="metadata-section">
                      <h4>Node Details</h4>
                      
                      <div class="metadata-field">
                        <span class="metadata-label">Title:</span>
                        <span class="metadata-value">
                          {{#if nodeLabel}}
                            <strong>{{nodeLabel.value}}</strong>
                          {{else}}
                            <strong>{{../iri}}</strong>
                          {{/if}}
                        </span>
                      </div>
                      
                      <div class="metadata-field">
                        <span class="metadata-label">Type:</span>
                        <span class="metadata-value">
                          {{#if (eq ../../hasChildren "true")}}
                            <i class="fa fa-folder" style="color: #ffc107; margin-right: 5px;"></i>
                            Folder ({{../../childCount}} children)
                          {{else}}
                            <i class="fa fa-file-text-o" style="color: #2196F3; margin-right: 5px;"></i>
                            Document
                          {{/if}}
                        </span>
                      </div>
                      
                      <div class="metadata-field">
                        <span class="metadata-label">IRI:</span>
                        <span class="metadata-value">{{node.value}}</span>
                      </div>
                      
                      {{#if techDescValue}}
                        <div class="technical-description">
                          <strong>File Technical Description:</strong> {{techDescValue.value}}
                        </div>
                      {{/if}}
                    </div>
                    
                    <!-- Record Metadata Section -->
                    <div class="metadata-section">
                      <h4>Record Metadata</h4>
                      
                      <div class="metadata-field">
                        <span class="metadata-label">Title:</span>
                        <span class="metadata-value">
                          {{#if titleLabel}}
                            {{titleLabel.value}}
                          {{else if title}}
                            {{title.value}}
                          {{else}}
                            <em>No title available</em>
                          {{/if}}
                        </span>
                      </div>
                      
                      <div class="metadata-field">
                        <span class="metadata-label">Creation Date:</span>
                        <span class="metadata-value">
                          {{#if creationDateLabel}}
                            {{creationDateLabel.value}}
                          {{else if creationDateNormalized}}
                            {{creationDateNormalized.value}}
                          {{else if creationDate}}
                            {{creationDate.value}}
                          {{else}}
                            <em>No creation date available</em>
                          {{/if}}
                        </span>
                      </div>
                      
                      <div class="metadata-field">
                        <span class="metadata-label">Modification Date:</span>
                        <span class="metadata-value">
                          {{#if modificationDateLabel}}
                            {{modificationDateLabel.value}}
                          {{else if modificationDateNormalized}}
                            {{modificationDateNormalized.value}}
                          {{else if modificationDate}}
                            {{modificationDate.value}}
                          {{else}}
                            <em>No modification date available</em>
                          {{/if}}
                        </span>
                      </div>
                    </div>
                    
                    <!-- Instantiation Metadata Section -->
                    {{#if instantiation}}
                      <div class="metadata-section">
                        <h4>Instantiation Metadata</h4>
                        
                        <div class="metadata-field">
                          <span class="metadata-label">File type:</span>
                          <span class="metadata-value">
                            {{#if instType}}
                              {{instType.value}}
                            {{else}}
                              <em>Not specified</em>
                            {{/if}}
                          </span>
                        </div>
                        
                        <!-- Group technical metadata by metadata set -->
                        {{#if ../bindings}}
                          <!-- File System Metadata -->
                          <div style="margin-top: 15px;">
                            <strong>File System Metadata</strong>
                            <table class="metadata-table">
                              <thead>
                                <tr>
                                  <th>Property</th>
                                  <th>Value</th>
                                </tr>
                              </thead>
                              <tbody>
                                {{#each ../bindings}}
                                  {{#if (and techMetadataLabel (eq metadataSetLabel.value "File system metadata"))}}
                                    <tr>
                                      <td>{{techMetadataTypeLabel.value}}</td>
                                      <td>{{techMetadataValue.value}}</td>
                                    </tr>
                                  {{/if}}
                                {{/each}}
                              </tbody>
                            </table>
                          </div>
                          
                          <!-- Content Metadata -->
                          <div style="margin-top: 15px;">
                            <strong>Content Metadata</strong>
                            <table class="metadata-table">
                              <thead>
                                <tr>
                                  <th>Property</th>
                                  <th>Value</th>
                                </tr>
                              </thead>
                              <tbody>
                                {{#each ../bindings}}
                                  {{#if (and techMetadataLabel (or (eq metadataSetLabel.value "Document content metadata") (eq metadataSetLabel.value "Image metadata")))}}
                                    <tr>
                                      <td>{{techMetadataTypeLabel.value}}</td>
                                      <td>{{techMetadataValue.value}}</td>
                                    </tr>
                                  {{/if}}
                                {{/each}}
                              </tbody>
                            </table>
                          </div>
                          
                          <!-- Other Technical Metadata -->
                          <div style="margin-top: 15px;">
                            <strong>Other Technical Metadata</strong>
                            <table class="metadata-table">
                              <thead>
                                <tr>
                                  <th>Category</th>
                                  <th>Property</th>
                                  <th>Value</th>
                                </tr>
                              </thead>
                              <tbody>
                                {{#each ../bindings}}
                                  {{#if (and techMetadataLabel (and (not (eq metadataSetLabel.value "File system metadata")) (and (not (eq metadataSetLabel.value "Document content metadata")) (not (eq metadataSetLabel.value "Image metadata")))))}}
                                    <tr>
                                      <td>{{#if metadataSetLabel}}{{metadataSetLabel.value}}{{else}}Other{{/if}}</td>
                                      <td>{{techMetadataTypeLabel.value}}</td>
                                      <td>{{techMetadataValue.value}}</td>
                                    </tr>
                                  {{/if}}
                                {{/each}}
                              </tbody>
                            </table>
                          </div>
                        {{/if}}
                      </div>
                    {{else}}
                      <div class="metadata-section">
                        <h4>Instantiation Metadata</h4>
                        <div class="no-metadata">
                          No instantiation metadata available for this record.
                        </div>
                      </div>
                    {{/if}}
                  {{/with}}
                {{else}}
                  <div class="loading-metadata">
                    <i class="fa fa-spinner fa-spin" style="font-size: 24px; color: #3498db;"></i>
                    <p>Loading metadata...</p>
                  </div>
                {{/if}}
              </template>
            </semantic-query>
          {{else}}
            <div class="metadata-section">
              <h4>Node Details</h4>
              <div class="no-metadata">
                Click on a node in the tree to view its metadata.
              </div>
            </div>
          {{/if}}
        </template>
      </mp-event-target-template-render>
      </div>
    </div>
  </div>
  
  <div style="background-color: white; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.05); padding: 15px; margin-top: 30px;">
    <h3 style="color: #2c3e50; border-bottom: 2px solid #3498db; padding-bottom: 8px; margin-bottom: 15px;">About this Advanced Tree</h3>
    <p>
      This tree demonstrates the <strong>SemanticTreeAdvanced</strong> component with lazy loading functionality and comprehensive metadata display.
      Unlike the regular semantic tree that loads all data at once, this version loads data progressively.
    </p>
    <strong>Key Features:</strong>
    <ul>
      <li><strong>Lazy Loading:</strong> Child nodes are loaded only when you click to expand a parent node</li>
      <li><strong>Performance:</strong> Initial load is faster as it only loads the first level of the hierarchy</li>
      <li><strong>Caching:</strong> Once loaded, child nodes are cached to avoid re-querying</li>
      <li><strong>Loading Indicators:</strong> Shows a spinner while loading child nodes</li>
      <li><strong>Dynamic Queries:</strong> Uses the <code>{{clickedNode}}</code> variable to inject the expanded node's IRI into the expand query</li>
      <li><strong>Node Highlighting:</strong> Supports highlighting specific nodes via events</li>
      <li><strong>Search Functionality:</strong> Search bar allows finding and highlighting nodes by label</li>
      <li><strong>Sorting:</strong> Customizable sorting by any field from the SPARQL query (Title, Node IRI, Child Count)</li>
      <li><strong>Related Nodes:</strong> Hover over any node to see a link icon <i class="fa fa-link"></i> that reveals options to find related nodes</li>
      <li><strong>Comprehensive Metadata:</strong> Click on any node to view detailed metadata including record information, dates, and technical properties</li>
    </ul>
    <strong>Usage:</strong>
    <ul>
      <li>Click on a folder icon <i class="fa fa-folder" style="color: #ffc107;"></i> to expand and load children</li>
      <li>Document icons <i class="fa fa-file-text-o" style="color: #2196F3;"></i> indicate leaf nodes (no children)</li>
      <li>Watch for the loading spinner when expanding nodes</li>
      <li>Use the search bar to find nodes by label - matching nodes will be highlighted and their paths expanded</li>
      <li>Use the sort controls at the top to sort by Title, Node IRI, or Number of Children</li>
      <li>Click the sort direction button to toggle between ascending/descending order</li>
      <li>Hover over any node to see a link icon <i class="fa fa-link"></i> - click it to find related nodes based on various criteria</li>
      <li>Click on any node to view its comprehensive metadata in the right panel</li>
      <li>Use the "Highlight Nodes" buttons below to test the highlighting feature</li>
    </ul>
  </div>
  
  <!-- Event Testing Section -->
  <div style="background-color: #f8f9fa; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.05); padding: 15px; margin-top: 20px;">
    <h3 style="color: #2c3e50; border-bottom: 2px solid #e74c3c; padding-bottom: 8px; margin-bottom: 15px;">
      <i class="fa fa-bolt" style="color: #e74c3c; margin-right: 8px;"></i>
      SemanticTreeHighlightNodes Event Testing
    </h3>
    <p>Test the new <strong>SemanticTreeHighlightNodes</strong> event by clicking the buttons below. This will highlight specific nodes in the tree and filter the view to show only highlighted paths.</p>
    
    <div style="display: flex; gap: 10px; flex-wrap: wrap; margin-bottom: 15px;">
      <mp-event-trigger 
        type='SemanticTreeHighlightNodes' 
        targets='["evangelisti-tree-advanced"]'
        data='{"nodeIds": ["http://ficlit.unibo.it/ArchivioEvangelisti/RS1_RS1"]}'>
        <button class="btn btn-primary" style="background-color: #3498db; border: none; padding: 8px 16px; border-radius: 4px; color: white;">
          <i class="fa fa-lightbulb-o" style="margin-right: 5px;"></i>
          Highlight Root Node
        </button>
      </mp-event-trigger>
      
      <mp-event-trigger 
        type='SemanticTreeHighlightNodes' 
        targets='["evangelisti-tree-advanced"]'
        data='{"nodeIds": ["http://ficlit.unibo.it/ArchivioEvangelisti/RS1_RS1_RS1_RS1_RS4_RR13", "http://ficlit.unibo.it/ArchivioEvangelisti/RS1_RS1_RS1_RS1_RS4_RR19", "http://ficlit.unibo.it/ArchivioEvangelisti/RS1_RS1_RS1_RS1_RS1_RR20", "http://ficlit.unibo.it/ArchivioEvangelisti/RS1_RS1_RS1_RS1_RS5_RR12"]}'>
        <button class="btn btn-warning" style="background-color: #f39c12; border: none; padding: 8px 16px; border-radius: 4px; color: white;">
          <i class="fa fa-star" style="margin-right: 5px;"></i>
          Highlight Multiple Deep Nodes
        </button>
      </mp-event-trigger>
      
      <mp-event-trigger 
        type='SemanticTreeHighlightNodes' 
        targets='["evangelisti-tree-advanced"]'
        data='{"nodeIds": []}'>
        <button class="btn btn-secondary" style="background-color: #95a5a6; border: none; padding: 8px 16px; border-radius: 4px; color: white;">
          <i class="fa fa-eraser" style="margin-right: 5px;"></i>
          Clear Highlighting
        </button>
      </mp-event-trigger>
    </div>
    
    <div style="background-color: #e8f4fd; border-left: 4px solid #3498db; padding: 10px; margin-top: 15px;">
      <strong>How it works:</strong>
      <ul style="margin: 5px 0 0 0; padding-left: 20px;">
        <li>The event sends a list of node IRIs to highlight</li>
        <li>The tree component receives the event and filters the view</li>
        <li>Only highlighted nodes and their paths to the root are shown</li>
        <li>Highlighted nodes get an orange background styling</li>
        <li>Check the browser console for event debugging information</li>
      </ul>
    </div>
  </div>
</div>
