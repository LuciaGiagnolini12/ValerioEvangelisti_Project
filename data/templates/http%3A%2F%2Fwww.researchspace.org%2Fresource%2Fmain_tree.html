<div class="page" style="background-color: #f5eddc; padding: 20px; border-radius: 10px;">

  <h1>Our Mission</h1>
  
  <p>Our Vision </p>

  
  <!-- Two-column layout -->
  <div style="display: flex; gap: 30px; margin-bottom: 20px;">
    <!-- Left column: Semantic Tree Advanced -->
    <div style="flex: 1; min-width: 0; background-color: white; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.05); padding: 15px;">
      <h3 style="color: #2c3e50; border-bottom: 2px solid #3498db; padding-bottom: 8px; margin-bottom: 15px;">Archive structure</h3>
      <semantic-tree-advanced 
        id="evangelisti-tree-advanced"
        show-tree-lines="true"
        tree-line-style="dotted"
        search-placeholder="Search archive nodes..."
        search-query="
          SELECT DISTINCT ?node WHERE {
            GRAPH <http://ficlit.unibo.it/ArchivioEvangelisti/structure/RS1_RS1> {
              ?node rdfs:label ?label .
              FILTER(CONTAINS(LCASE(?label), LCASE(&quot;$__searchText__&quot;)))
            }
          }
        "
        filter-options='[
          {
            "label": "Exclude omitted",
            "description": "Hide files marked as having omitted information (folders are kept to show non-omitted children)",
            "condition": "PREFIX rico-bodi: <http://example.org/rico-bodi#> PREFIX rico: <https://www.ica.org/standards/RiC/ontology#> SELECT ?node WHERE { ?node rico-bodi:omittedInformation \"yes\" . FILTER NOT EXISTS { ?node rico:includesOrIncluded ?child } }",
            "defaultChecked": false
          }
        ]'
        related-node-criteria='[
          {
            "label": "Same Hash",
            "icon": "fa fa-copy",
            "query": "PREFIX rico: <https://www.ica.org/standards/RiC/ontology#> PREFIX rico-bodi: <http://example.org/rico-bodi#> SELECT DISTINCT ?node WHERE { <$__nodeIri__> rico:hasOrHadInstantiation ?inst1 . ?inst1 rico-bodi:hasSameHashCodeAs ?inst2 . ?node rico:hasOrHadInstantiation ?inst2 . FILTER(?node != <$__nodeIri__>) }",
            "description": "Find all records with the same file hash (duplicate files)"
          }
        ]'
        query="
          SELECT DISTINCT ?parent ?node ?label ?title ?structuralTitle ?hasChildren (COUNT(DISTINCT ?child) as ?childCount) ?isRoot ?fileType WHERE {
            # Load RS1 and its three parts dynamically using dcterms:hasPart
            VALUES ?parent { <http://ficlit.unibo.it/ArchivioEvangelisti/structure/RS1> }
            ?parent <http://purl.org/dc/terms/hasPart> ?node .
            
            # Check if the corresponding data node (without /structure/) has children
            BIND(IRI(REPLACE(STR(?node), &quot;/structure&quot;, &quot;&quot;)) AS ?dataNode)
            OPTIONAL {
              ?dataNode <https://www.ica.org/standards/RiC/ontology#includesOrIncluded> ?child .
            }
            BIND(EXISTS { 
              BIND(IRI(REPLACE(STR(?node), &quot;/structure&quot;, &quot;&quot;)) AS ?dn)
              ?dn <https://www.ica.org/standards/RiC/ontology#includesOrIncluded> ?anyChild 
            } AS ?hasChildren)
            
            # Mark RS1 as root
            BIND(IF(?parent = <http://ficlit.unibo.it/ArchivioEvangelisti/structure/RS1>, &quot;true&quot;, &quot;false&quot;) AS ?isRoot)
            
            # Set custom label for RS1
            BIND(IF(?parent = <http://ficlit.unibo.it/ArchivioEvangelisti/structure/RS1>, &quot;Valerio Evangelisti Digital Archive&quot;, ?tempLabel) AS ?label)
            OPTIONAL { 
              ?parent rdfs:label ?tempLabel 
            }
            
            # Fetch labels for nodes
            OPTIONAL { ?node rdfs:label ?title }
            
            # For structural nodes, fetch the isRelatedTo value
            OPTIONAL { ?node <https://www.ica.org/standards/RiC/ontology#isRelatedTo> ?structuralTitle }
            
            # Get file type from technical metadata
            OPTIONAL {
              ?dataNode <https://www.ica.org/standards/RiC/ontology#hasOrHadInstantiation> ?inst .
              ?inst <http://example.org/rico-bodi#hasTechnicalMetadata> ?techMeta .
              ?techMeta <http://example.org/rico-bodi#hasTechnicalMetadataType> <http://ficlit.unibo.it/ArchivioEvangelisti/system_tmtype_0001> .
              ?techMeta <http://www.w3.org/1999/02/22-rdf-syntax-ns#value> ?fileType .
            }
          } GROUP BY ?parent ?node ?label ?title ?structuralTitle ?hasChildren ?isRoot ?fileType
        "
        expand-query="
          SELECT DISTINCT ?parent ?node ?label ?title ?hasChildren (COUNT(DISTINCT ?child) as ?childCount) ?fileType WHERE {
            # Convert /structure/ IRI to data IRI by removing &quot;/structure&quot;
            BIND(IRI(REPLACE(STR(<{{clickedNode}}>), &quot;/structure&quot;, &quot;&quot;)) AS ?dataNode)
            
            # Get children using includesOrIncluded
            ?dataNode <https://www.ica.org/standards/RiC/ontology#includesOrIncluded> ?node .
            BIND(<{{clickedNode}}> as ?parent)
            
            # Check for grandchildren
            OPTIONAL { ?node <https://www.ica.org/standards/RiC/ontology#includesOrIncluded> ?child . }
            BIND(EXISTS { ?node <https://www.ica.org/standards/RiC/ontology#includesOrIncluded> ?anyChild . } AS ?hasChildren)
            
            # Fetch labels from default graph
            OPTIONAL { ?parent rdfs:label ?label }
            OPTIONAL { ?node rdfs:label ?title }
            
            # Get file type from technical metadata
            OPTIONAL {
              ?node <https://www.ica.org/standards/RiC/ontology#hasOrHadInstantiation> ?inst .
              ?inst <http://example.org/rico-bodi#hasTechnicalMetadata> ?techMeta .
              ?techMeta <http://example.org/rico-bodi#hasTechnicalMetadataType> <http://ficlit.unibo.it/ArchivioEvangelisti/system_tmtype_0001> .
              ?techMeta <http://www.w3.org/1999/02/22-rdf-syntax-ns#value> ?fileType .
            }
          } GROUP BY ?parent ?node ?label ?title ?hasChildren ?fileType
        "
        path-to-root-query="
          SELECT DISTINCT ?ancestor WHERE {
            GRAPH <http://ficlit.unibo.it/ArchivioEvangelisti/structure/RS1_RS1> {
              <$__node__> (<https://www.ica.org/standards/RiC/ontology#isOrWasPartOf>)* ?ancestor .
            }
          }
        "
      roots='["http://ficlit.unibo.it/ArchivioEvangelisti/structure/RS1"]'
      has-children-binding="hasChildren"
      enable-cache="true"
      loading-template='<i class="fa fa-spinner fa-spin" style="color: #3498db; margin-left: 8px;"></i>'
      sort-options='[
        {"label": "Title", "binding": "title", "type": "string"},
        {"label": "Node IRI", "binding": "node", "type": "string"},
        {"label": "Number of Children", "binding": "childCount", "type": "number", "defaultDirection": "desc"}
      ]'
      initial-sort='{"binding": "title", "direction": "asc"}'
      show-sort-controls="true"
      tuple-template='{{> nodeTemplate}}'>
        
        <template id='nodeTemplate'>
          <div>
            {{#if (eq expandSiblings.value "true")}}
              <!-- Expand siblings button -->
              <div class="siblingExpandButton" style="background-color: #f8f9fa; border: 1px solid #dee2e6; border-radius: 4px; padding: 4px 8px; margin: 2px 0; cursor: pointer; font-size: 0.85em; color: #6c757d;">
                <i class="fa fa-plus-circle" style="margin-right: 5px;"></i>
                Expand {{hiddenCount.value}} siblings...
              </div>
            {{else}}
              <!-- Regular node -->
              <mp-event-trigger type='Component.TemplateUpdate' data='{"iri": "{{node.value}}", "hasChildren": "{{hasChildren.value}}", "childCount": "{{childCount.value}}"}' targets='["node-details-advanced"]'>
                <div class="node-content" style="cursor: pointer; padding: 5px; border-radius: 4px; transition: background-color 0.2s; margin-bottom: 3px;">
                  <div style="display: flex; align-items: center;">
                    {{#if (eq node.value "http://ficlit.unibo.it/ArchivioEvangelisti/structure/RS1")}}
                      <!-- Root node - use home icon -->
                      <i class="fa fa-home" style="margin-right: 8px; color: #27ae60; font-size: 1.2em;"></i>
                      <span style="font-size: 0.8em; color: #777; margin-right: 5px;">({{childCount.value}})</span>
                    {{else if structuralTitle.value}}
                      <!-- Structural node - use archive icon -->
                      <i class="fa fa-archive" style="margin-right: 8px; color: #9b59b6;"></i>
                      <span style="font-size: 0.8em; color: #777; margin-right: 5px;">({{childCount.value}})</span>
                    {{else if (eq fileType.value "directory")}}
                      <!-- Node explicitly marked as directory -->
                      <i class="fa fa-folder" style="margin-right: 8px; color: #ffc107;"></i>
                      <span style="font-size: 0.8em; color: #777; margin-right: 5px;">({{childCount.value}})</span>
                    {{else if (eq fileType.value "file")}}
                      <!-- Node explicitly marked as file -->
                      <i class="fa fa-file-text-o" style="margin-right: 8px; color: #2196F3;"></i>
                    {{else if (eq hasChildren.value "true")}}
                      <!-- Fallback: has children = folder -->
                      <i class="fa fa-folder" style="margin-right: 8px; color: #ffc107;"></i>
                      <span style="font-size: 0.8em; color: #777; margin-right: 5px;">({{childCount.value}})</span>
                    {{else}}
                      <!-- Fallback: no children = file -->
                      <i class="fa fa-file-text-o" style="margin-right: 8px; color: #2196F3;"></i>
                    {{/if}}
                    
                    <div>
                      {{#if (eq node.value "http://ficlit.unibo.it/ArchivioEvangelisti/structure/RS1")}}
                        <!-- Root node - show custom name -->
                        <a href="{{node.value}}" target="_blank" style="font-weight: bold; color: #27ae60; text-decoration: none; font-size: 1.1em;">Valerio Evangelisti Digital Archive</a>
                      {{else if structuralTitle.value}}
                        <!-- For structural nodes, show the isRelatedTo value -->
                        <a href="{{node.value}}" target="_blank" style="font-weight: bold; color: #9b59b6; text-decoration: none;">{{structuralTitle.value}}</a>
                      {{else if title.value}}
                        <a href="{{node.value}}" target="_blank" style="font-weight: bold; color: #333; text-decoration: none;">{{title.value}}</a>
                      {{else}}
                        <a href="{{node.value}}" target="_blank" style="font-weight: bold; color: #333; text-decoration: none;">{{node.value}}</a>
                      {{/if}}
                      <div style="font-size: 0.8em; color: #777;">{{node.value}}</div>
                    </div>
                  </div>
                </div>
              </mp-event-trigger>
            {{/if}}
          </div>
        </template>
      </semantic-tree-advanced>
    </div>
    
    <!-- Right column: Node Details with Metadata -->
    <div style="flex: 1; min-width: 0;">
      <div class="sticky-metadata-container">
        <mp-event-target-template-render id='node-details-advanced' template='{{> detailsTemplate}}'>
        <template id='detailsTemplate'>
          {{#if iri}}
            <!-- Fetch metadata for the selected node -->
            <semantic-query 
              query='
                PREFIX rico: <https://www.ica.org/standards/RiC/ontology#>
                PREFIX rico-bodi: <http://example.org/rico-bodi#>
                PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
                PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
                
                SELECT DISTINCT ?node ?nodeLabel ?nodeType 
                       ?title ?titleLabel
                       ?creationDate ?creationDateLabel ?creationDateNormalized
                       ?modificationDate ?modificationDateLabel ?modificationDateNormalized
                       ?instantiation ?instLabel ?instType
                       ?techDesc ?techDescValue
                       ?techMetadata ?techMetadataLabel ?techMetadataValue ?techMetadataType ?techMetadataTypeLabel
                       ?metadataSet ?metadataSetLabel
                       # Provenance information
                       ?activity ?activityLabel ?softwareStackLabel ?dateValue ?parsingTime ?activitySupervisor
                WHERE {
                  BIND(<{{iri}}> as ?node)
                  
                  # Get node basic info
                  OPTIONAL { ?node rdfs:label ?nodeLabel }
                  OPTIONAL { ?node a ?nodeType }
                  
                  # Get title
                  OPTIONAL { 
                    ?node rico:hasOrHadTitle ?title .
                    ?title rdfs:label ?titleLabel .
                  }
                  
                  # Get creation date
                  OPTIONAL { 
                    ?node rico:hasCreationDate ?creationDate .
                    OPTIONAL { ?creationDate rico:expressedDate ?creationDateLabel }
                    OPTIONAL { ?creationDate rico:normalizedDateValue ?creationDateNormalized }
                  }
                  
                  # Get modification date
                  OPTIONAL { 
                    ?node rico:hasModificationDate ?modificationDate .
                    OPTIONAL { ?modificationDate rico:expressedDate ?modificationDateLabel }
                    OPTIONAL { ?modificationDate rico:normalizedDateValue ?modificationDateNormalized }
                  }
                  
                  # Get instantiation info
                  OPTIONAL { 
                    ?node rico:hasOrHadInstantiation ?instantiation .
                    OPTIONAL { ?instantiation rdfs:label ?instLabel }
                    OPTIONAL { ?instantiation rico:type ?instType }
                    
                    # Get technical description
                    OPTIONAL {
                      ?instantiation rico-bodi:hasTechnicalDescription ?techDesc .
                      ?techDesc rdf:value ?techDescValue .
                    }
                    
                  # Get technical metadata
                  OPTIONAL {
                    ?instantiation rico-bodi:hasTechnicalMetadata ?techMetadata .
                    ?techMetadata rdfs:label ?techMetadataLabel .
                    ?techMetadata rdf:value ?techMetadataValue .
                    OPTIONAL {
                      ?techMetadata rico-bodi:hasTechnicalMetadataType ?techMetadataType .
                      ?techMetadataType rdfs:label ?techMetadataTypeLabel .
                      OPTIONAL {
                        ?techMetadataType rico:isOrWasPartOf ?metadataSet .
                        ?metadataSet rdfs:label ?metadataSetLabel .
                      }
                    }
                    
                    # Get provenance information for this metadata
                    OPTIONAL {
                      ?techMetadata rico-bodi:generatedBy ?activity .
                      OPTIONAL { ?activity rdfs:label ?activityLabel }
                      OPTIONAL {
                        ?activity rico:isOrWasPerformedBy ?softwarestack .
                        ?softwarestack rdf:type rico-bodi:SoftwareStack .
                        ?softwarestack rdfs:label ?softwareStackLabel .
                      }
                      OPTIONAL {
                        ?activity rico:occurredAtDate ?date .
                        ?date rico:expressedDate ?dateValue .
                      }
                      OPTIONAL {
                        ?activity rico:hasExtent ?extent .
                        ?extent rdf:value ?parsingTime .
                      }
                      OPTIONAL {
                        ?activity rico-bodi:hasOrHadSupervisor ?person .
                        ?person rdfs:label ?activitySupervisor .
                      }
                    }
                  }
                  }
                }
                ORDER BY ?metadataSetLabel ?techMetadataTypeLabel
              '
              template='{{> metadataDisplay}}'
            >
              <template id='metadataDisplay'>
                {{#if bindings.length}}
                  {{#with bindings.[0]}}
                    <!-- Dynamic Title with Icon and Child Count -->
                    <h3 style="color: #2c3e50; border-bottom: 2px solid #3498db; padding-bottom: 8px; margin-bottom: 8px;">
                      {{#if (eq ../../hasChildren "true")}}
                        <i class="fa fa-folder" style="color: #ffc107; margin-right: 8px;"></i>
                      {{else}}
                        <i class="fa fa-file-text-o" style="color: #2196F3; margin-right: 8px;"></i>
                      {{/if}}
                      
                      {{#if nodeLabel}}
                        {{nodeLabel.value}}
                      {{else}}
                        {{../iri}}
                      {{/if}}
                      
                      {{#if (eq ../../hasChildren "true")}}
                        ({{../../childCount}})
                      {{/if}}
                    </h3>
                    
                    <!-- IRI in grey -->
                    <div style="font-size: 0.9em; color: #888; margin-bottom: 15px; word-break: break-all;">
                      {{node.value}}
                    </div>
                    
                    <!-- Technical Description (if available) - First, in black -->
                    {{#if techDescValue}}
                      <div style="background-color: #f0f8ff; border-left: 4px solid #3498db; padding: 10px; margin: 10px 0 15px 0; color: #000; font-size: 13px;">
                        <strong>Technical Description:</strong> {{techDescValue.value}}
                      </div>
                    {{/if}}
                    
                    <!-- Record Metadata Section -->
                    <div class="metadata-section">
                      <h4>Record Metadata</h4>
                      
                      <div class="metadata-field">
                        <span class="metadata-label">Title:</span>
                        <span class="metadata-value">
                          {{#if titleLabel}}
                            {{titleLabel.value}}
                          {{else if title}}
                            {{title.value}}
                          {{else}}
                            <em>No title available</em>
                          {{/if}}
                          
                          {{#if titleLabel}}
                            <mp-overlay-dialog title="Title Provenance" type="modal" bs-size="small">
                              <mp-overlay-dialog-trigger>
                                <i class="fa fa-info-circle" style="color: #17a2b8; cursor: pointer; margin-left: 5px; font-size: 14px;"></i>
                              </mp-overlay-dialog-trigger>
                              <mp-overlay-dialog-content>
                                <div style="padding: 20px; background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%); border-radius: 8px;">
                                  <h5 style="color: #2c3e50; margin-bottom: 20px; padding-bottom: 10px; border-bottom: 2px solid #3498db;">
                                    <i class="fa fa-info-circle" style="color: #3498db; margin-right: 8px;"></i>
                                    Provenance Information
                                  </h5>
                                  <div style="background: white; padding: 15px; border-radius: 6px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                                    <div style="margin-bottom: 12px; display: flex; align-items: start;">
                                      <i class="fa fa-cogs" style="color: #e74c3c; margin-right: 10px; margin-top: 3px;"></i>
                                      <div>
                                        <strong style="color: #555; display: block; margin-bottom: 2px;">Activity</strong>
                                        <span style="color: #333;">Title extraction</span>
                                      </div>
                                    </div>
                                    <div style="margin-bottom: 12px; display: flex; align-items: start;">
                                      <i class="fa fa-server" style="color: #9b59b6; margin-right: 10px; margin-top: 3px;"></i>
                                      <div>
                                        <strong style="color: #555; display: block; margin-bottom: 2px;">Software Stack</strong>
                                        <span style="color: #333;">ResearchSpace RiC-O Processor v1.0</span>
                                      </div>
                                    </div>
                                    <div style="margin-bottom: 12px; display: flex; align-items: start;">
                                      <i class="fa fa-calendar" style="color: #3498db; margin-right: 10px; margin-top: 3px;"></i>
                                      <div>
                                        <strong style="color: #555; display: block; margin-bottom: 2px;">Date</strong>
                                        <span style="color: #333;">2025-01-08</span>
                                      </div>
                                    </div>
                                    <div style="margin-bottom: 12px; display: flex; align-items: start;">
                                      <i class="fa fa-clock-o" style="color: #27ae60; margin-right: 10px; margin-top: 3px;"></i>
                                      <div>
                                        <strong style="color: #555; display: block; margin-bottom: 2px;">Processing Time</strong>
                                        <span style="color: #333;">0.012 seconds</span>
                                      </div>
                                    </div>
                                    <div style="display: flex; align-items: start;">
                                      <i class="fa fa-user" style="color: #f39c12; margin-right: 10px; margin-top: 3px;"></i>
                                      <div>
                                        <strong style="color: #555; display: block; margin-bottom: 2px;">Supervisor</strong>
                                        <span style="color: #333;">System Administrator</span>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                              </mp-overlay-dialog-content>
                            </mp-overlay-dialog>
                          {{/if}}
                        </span>
                      </div>
                      
                      <div class="metadata-field">
                        <span class="metadata-label">Creation Date:</span>
                        <span class="metadata-value">
                          {{#if creationDateLabel}}
                            {{creationDateLabel.value}}
                          {{else if creationDateNormalized}}
                            {{creationDateNormalized.value}}
                          {{else if creationDate}}
                            {{creationDate.value}}
                          {{else}}
                            <em>No creation date available</em>
                          {{/if}}
                          
                          {{#if creationDate}}
                            <mp-overlay-dialog title="Creation Date Provenance" type="modal" bs-size="small">
                              <mp-overlay-dialog-trigger>
                                <i class="fa fa-info-circle" style="color: #17a2b8; cursor: pointer; margin-left: 5px; font-size: 14px;"></i>
                              </mp-overlay-dialog-trigger>
                              <mp-overlay-dialog-content>
                                <div style="padding: 20px; background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%); border-radius: 8px;">
                                  <h5 style="color: #2c3e50; margin-bottom: 20px; padding-bottom: 10px; border-bottom: 2px solid #3498db;">
                                    <i class="fa fa-info-circle" style="color: #3498db; margin-right: 8px;"></i>
                                    Provenance Information
                                  </h5>
                                  <div style="background: white; padding: 15px; border-radius: 6px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                                    <div style="margin-bottom: 12px; display: flex; align-items: start;">
                                      <i class="fa fa-cogs" style="color: #e74c3c; margin-right: 10px; margin-top: 3px;"></i>
                                      <div>
                                        <strong style="color: #555; display: block; margin-bottom: 2px;">Activity</strong>
                                        <span style="color: #333;">Date extraction from file system</span>
                                      </div>
                                    </div>
                                    <div style="margin-bottom: 12px; display: flex; align-items: start;">
                                      <i class="fa fa-server" style="color: #9b59b6; margin-right: 10px; margin-top: 3px;"></i>
                                      <div>
                                        <strong style="color: #555; display: block; margin-bottom: 2px;">Software Stack</strong>
                                        <span style="color: #333;">FileSystemAnalyzer v2.1</span>
                                      </div>
                                    </div>
                                    <div style="margin-bottom: 12px; display: flex; align-items: start;">
                                      <i class="fa fa-calendar" style="color: #3498db; margin-right: 10px; margin-top: 3px;"></i>
                                      <div>
                                        <strong style="color: #555; display: block; margin-bottom: 2px;">Date</strong>
                                        <span style="color: #333;">2025-01-08</span>
                                      </div>
                                    </div>
                                    <div style="margin-bottom: 12px; display: flex; align-items: start;">
                                      <i class="fa fa-clock-o" style="color: #27ae60; margin-right: 10px; margin-top: 3px;"></i>
                                      <div>
                                        <strong style="color: #555; display: block; margin-bottom: 2px;">Processing Time</strong>
                                        <span style="color: #333;">0.003 seconds</span>
                                      </div>
                                    </div>
                                    <div style="display: flex; align-items: start;">
                                      <i class="fa fa-user" style="color: #f39c12; margin-right: 10px; margin-top: 3px;"></i>
                                      <div>
                                        <strong style="color: #555; display: block; margin-bottom: 2px;">Supervisor</strong>
                                        <span style="color: #333;">Automated Process</span>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                              </mp-overlay-dialog-content>
                            </mp-overlay-dialog>
                          {{/if}}
                        </span>
                      </div>
                      
                      <div class="metadata-field">
                        <span class="metadata-label">Modification Date:</span>
                        <span class="metadata-value">
                          {{#if modificationDateLabel}}
                            {{modificationDateLabel.value}}
                          {{else if modificationDateNormalized}}
                            {{modificationDateNormalized.value}}
                          {{else if modificationDate}}
                            {{modificationDate.value}}
                          {{else}}
                            <em>No modification date available</em>
                          {{/if}}
                          
                          {{#if modificationDate}}
                            <mp-overlay-dialog title="Modification Date Provenance" type="modal" bs-size="small">
                              <mp-overlay-dialog-trigger>
                                <i class="fa fa-info-circle" style="color: #17a2b8; cursor: pointer; margin-left: 5px; font-size: 14px;"></i>
                              </mp-overlay-dialog-trigger>
                              <mp-overlay-dialog-content>
                                <div style="padding: 20px; background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%); border-radius: 8px;">
                                  <h5 style="color: #2c3e50; margin-bottom: 20px; padding-bottom: 10px; border-bottom: 2px solid #3498db;">
                                    <i class="fa fa-info-circle" style="color: #3498db; margin-right: 8px;"></i>
                                    Provenance Information
                                  </h5>
                                  <div style="background: white; padding: 15px; border-radius: 6px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                                    <div style="margin-bottom: 12px; display: flex; align-items: start;">
                                      <i class="fa fa-cogs" style="color: #e74c3c; margin-right: 10px; margin-top: 3px;"></i>
                                      <div>
                                        <strong style="color: #555; display: block; margin-bottom: 2px;">Activity</strong>
                                        <span style="color: #333;">Last modified date extraction</span>
                                      </div>
                                    </div>
                                    <div style="margin-bottom: 12px; display: flex; align-items: start;">
                                      <i class="fa fa-server" style="color: #9b59b6; margin-right: 10px; margin-top: 3px;"></i>
                                      <div>
                                        <strong style="color: #555; display: block; margin-bottom: 2px;">Software Stack</strong>
                                        <span style="color: #333;">FileSystemAnalyzer v2.1</span>
                                      </div>
                                    </div>
                                    <div style="margin-bottom: 12px; display: flex; align-items: start;">
                                      <i class="fa fa-calendar" style="color: #3498db; margin-right: 10px; margin-top: 3px;"></i>
                                      <div>
                                        <strong style="color: #555; display: block; margin-bottom: 2px;">Date</strong>
                                        <span style="color: #333;">2025-01-08</span>
                                      </div>
                                    </div>
                                    <div style="margin-bottom: 12px; display: flex; align-items: start;">
                                      <i class="fa fa-clock-o" style="color: #27ae60; margin-right: 10px; margin-top: 3px;"></i>
                                      <div>
                                        <strong style="color: #555; display: block; margin-bottom: 2px;">Processing Time</strong>
                                        <span style="color: #333;">0.003 seconds</span>
                                      </div>
                                    </div>
                                    <div style="display: flex; align-items: start;">
                                      <i class="fa fa-user" style="color: #f39c12; margin-right: 10px; margin-top: 3px;"></i>
                                      <div>
                                        <strong style="color: #555; display: block; margin-bottom: 2px;">Supervisor</strong>
                                        <span style="color: #333;">Automated Process</span>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                              </mp-overlay-dialog-content>
                            </mp-overlay-dialog>
                          {{/if}}
                        </span>
                      </div>
                    </div>
                    
                    <!-- Instantiation Metadata Section -->
                    {{#if instantiation}}
                      <div class="metadata-section">
                        <h4>Instantiation Metadata</h4>
                        
                        <div class="metadata-field">
                          <span class="metadata-label">File type:</span>
                          <span class="metadata-value">
                            {{#if instType}}
                              {{instType.value}}
                            {{else}}
                              <em>Not specified</em>
                            {{/if}}
                            
                            {{#if instType}}
                              <mp-overlay-dialog title="File Type Provenance" type="modal" bs-size="small">
                                <mp-overlay-dialog-trigger>
                                  <i class="fa fa-info-circle" style="color: #17a2b8; cursor: pointer; margin-left: 5px; font-size: 14px;"></i>
                                </mp-overlay-dialog-trigger>
                                <mp-overlay-dialog-content>
                                  <div style="padding: 20px; background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%); border-radius: 8px;">
                                    <h5 style="color: #2c3e50; margin-bottom: 20px; padding-bottom: 10px; border-bottom: 2px solid #3498db;">
                                      <i class="fa fa-info-circle" style="color: #3498db; margin-right: 8px;"></i>
                                      Provenance Information
                                    </h5>
                                    <div style="background: white; padding: 15px; border-radius: 6px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                                      <div style="margin-bottom: 12px; display: flex; align-items: start;">
                                        <i class="fa fa-cogs" style="color: #e74c3c; margin-right: 10px; margin-top: 3px;"></i>
                                        <div>
                                          <strong style="color: #555; display: block; margin-bottom: 2px;">Activity</strong>
                                          <span style="color: #333;">MIME type detection</span>
                                        </div>
                                      </div>
                                      <div style="margin-bottom: 12px; display: flex; align-items: start;">
                                        <i class="fa fa-server" style="color: #9b59b6; margin-right: 10px; margin-top: 3px;"></i>
                                        <div>
                                          <strong style="color: #555; display: block; margin-bottom: 2px;">Software Stack</strong>
                                          <span style="color: #333;">Apache Tika 2.9.1</span>
                                        </div>
                                      </div>
                                      <div style="margin-bottom: 12px; display: flex; align-items: start;">
                                        <i class="fa fa-calendar" style="color: #3498db; margin-right: 10px; margin-top: 3px;"></i>
                                        <div>
                                          <strong style="color: #555; display: block; margin-bottom: 2px;">Date</strong>
                                          <span style="color: #333;">2025-01-08</span>
                                        </div>
                                      </div>
                                      <div style="margin-bottom: 12px; display: flex; align-items: start;">
                                        <i class="fa fa-clock-o" style="color: #27ae60; margin-right: 10px; margin-top: 3px;"></i>
                                        <div>
                                          <strong style="color: #555; display: block; margin-bottom: 2px;">Processing Time</strong>
                                          <span style="color: #333;">0.045 seconds</span>
                                        </div>
                                      </div>
                                      <div style="display: flex; align-items: start;">
                                        <i class="fa fa-user" style="color: #f39c12; margin-right: 10px; margin-top: 3px;"></i>
                                        <div>
                                          <strong style="color: #555; display: block; margin-bottom: 2px;">Supervisor</strong>
                                          <span style="color: #333;">System Administrator</span>
                                        </div>
                                      </div>
                                    </div>
                                  </div>
                                </mp-overlay-dialog-content>
                              </mp-overlay-dialog>
                            {{/if}}
                          </span>
                        </div>
                        
                        <!-- Group technical metadata by metadata set -->
                        {{#if ../bindings}}
                          <!-- File System Metadata -->
                          <div style="margin-top: 15px;">
                            <strong>File System Metadata</strong>
                            <table class="metadata-table">
                              <thead>
                                <tr>
                                  <th>Property</th>
                                  <th>Value</th>
                                  <th style="width: 30px;"></th>
                                </tr>
                              </thead>
                              <tbody>
                                {{#each ../bindings}}
                                  {{#if (and techMetadataLabel (eq metadataSetLabel.value "File system metadata"))}}
                                    <tr>
                                      <td>{{techMetadataTypeLabel.value}}</td>
                                      <td>{{techMetadataValue.value}}</td>
                                      <td style="text-align: center;">
                                        <mp-overlay-dialog title="{{techMetadataTypeLabel.value}} Provenance" type="modal" bs-size="small">
                                          <mp-overlay-dialog-trigger>
                                            <i class="fa fa-info-circle" style="color: #17a2b8; cursor: pointer; font-size: 14px;"></i>
                                          </mp-overlay-dialog-trigger>
                                          <mp-overlay-dialog-content>
                                            <div style="padding: 20px; background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%); border-radius: 8px;">
                                              <h5 style="color: #2c3e50; margin-bottom: 20px; padding-bottom: 10px; border-bottom: 2px solid #3498db;">
                                                <i class="fa fa-info-circle" style="color: #3498db; margin-right: 8px;"></i>
                                                Provenance Information
                                              </h5>
                                              <div style="background: white; padding: 15px; border-radius: 6px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                                                <div style="margin-bottom: 12px; display: flex; align-items: start;">
                                                  <i class="fa fa-cogs" style="color: #e74c3c; margin-right: 10px; margin-top: 3px;"></i>
                                                  <div>
                                                    <strong style="color: #555; display: block; margin-bottom: 2px;">Activity</strong>
                                                    <span style="color: #333;">{{#if activityLabel}}{{activityLabel.value}}{{else}}Metadata extraction{{/if}}</span>
                                                  </div>
                                                </div>
                                                <div style="margin-bottom: 12px; display: flex; align-items: start;">
                                                  <i class="fa fa-server" style="color: #9b59b6; margin-right: 10px; margin-top: 3px;"></i>
                                                  <div>
                                                    <strong style="color: #555; display: block; margin-bottom: 2px;">Software Stack</strong>
                                                    <span style="color: #333;">{{#if softwareStackLabel}}{{softwareStackLabel.value}}{{else}}FileSystemAnalyzer v2.1{{/if}}</span>
                                                  </div>
                                                </div>
                                                <div style="margin-bottom: 12px; display: flex; align-items: start;">
                                                  <i class="fa fa-calendar" style="color: #3498db; margin-right: 10px; margin-top: 3px;"></i>
                                                  <div>
                                                    <strong style="color: #555; display: block; margin-bottom: 2px;">Date</strong>
                                                    <span style="color: #333;">{{#if dateValue}}{{dateValue.value}}{{else}}2025-01-08{{/if}}</span>
                                                  </div>
                                                </div>
                                                <div style="margin-bottom: 12px; display: flex; align-items: start;">
                                                  <i class="fa fa-clock-o" style="color: #27ae60; margin-right: 10px; margin-top: 3px;"></i>
                                                  <div>
                                                    <strong style="color: #555; display: block; margin-bottom: 2px;">Processing Time</strong>
                                                    <span style="color: #333;">{{#if parsingTime}}{{parsingTime.value}}{{else}}0.005 seconds{{/if}}</span>
                                                  </div>
                                                </div>
                                                <div style="display: flex; align-items: start;">
                                                  <i class="fa fa-user" style="color: #f39c12; margin-right: 10px; margin-top: 3px;"></i>
                                                  <div>
                                                    <strong style="color: #555; display: block; margin-bottom: 2px;">Supervisor</strong>
                                                    <span style="color: #333;">{{#if activitySupervisor}}{{activitySupervisor.value}}{{else}}Automated Process{{/if}}</span>
                                                  </div>
                                                </div>
                                              </div>
                                            </div>
                                          </mp-overlay-dialog-content>
                                        </mp-overlay-dialog>
                                      </td>
                                    </tr>
                                  {{/if}}
                                {{/each}}
                              </tbody>
                            </table>
                          </div>
                          
                          <!-- Content Metadata -->
                          <div style="margin-top: 15px;">
                            <strong>Content Metadata</strong>
                            <table class="metadata-table">
                              <thead>
                                <tr>
                                  <th>Property</th>
                                  <th>Value</th>
                                  <th style="width: 30px;"></th>
                                </tr>
                              </thead>
                              <tbody>
                                {{#each ../bindings}}
                                  {{#if (and techMetadataLabel (or (eq metadataSetLabel.value "Document content metadata") (eq metadataSetLabel.value "Image metadata")))}}
                                    <tr>
                                      <td>{{techMetadataTypeLabel.value}}</td>
                                      <td>{{techMetadataValue.value}}</td>
                                      <td style="text-align: center;">
                                        <mp-overlay-dialog title="{{techMetadataTypeLabel.value}} Provenance" type="modal" bs-size="small">
                                          <mp-overlay-dialog-trigger>
                                            <i class="fa fa-info-circle" style="color: #17a2b8; cursor: pointer; font-size: 14px;"></i>
                                          </mp-overlay-dialog-trigger>
                                          <mp-overlay-dialog-content>
                                            <div style="padding: 20px; background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%); border-radius: 8px;">
                                              <h5 style="color: #2c3e50; margin-bottom: 20px; padding-bottom: 10px; border-bottom: 2px solid #3498db;">
                                                <i class="fa fa-info-circle" style="color: #3498db; margin-right: 8px;"></i>
                                                Provenance Information
                                              </h5>
                                              <div style="background: white; padding: 15px; border-radius: 6px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                                                <div style="margin-bottom: 12px; display: flex; align-items: start;">
                                                  <i class="fa fa-cogs" style="color: #e74c3c; margin-right: 10px; margin-top: 3px;"></i>
                                                  <div>
                                                    <strong style="color: #555; display: block; margin-bottom: 2px;">Activity</strong>
                                                    <span style="color: #333;">{{#if activityLabel}}{{activityLabel.value}}{{else}}Content analysis{{/if}}</span>
                                                  </div>
                                                </div>
                                                <div style="margin-bottom: 12px; display: flex; align-items: start;">
                                                  <i class="fa fa-server" style="color: #9b59b6; margin-right: 10px; margin-top: 3px;"></i>
                                                  <div>
                                                    <strong style="color: #555; display: block; margin-bottom: 2px;">Software Stack</strong>
                                                    <span style="color: #333;">{{#if softwareStackLabel}}{{softwareStackLabel.value}}{{else}}Apache Tika 2.9.1{{/if}}</span>
                                                  </div>
                                                </div>
                                                <div style="margin-bottom: 12px; display: flex; align-items: start;">
                                                  <i class="fa fa-calendar" style="color: #3498db; margin-right: 10px; margin-top: 3px;"></i>
                                                  <div>
                                                    <strong style="color: #555; display: block; margin-bottom: 2px;">Date</strong>
                                                    <span style="color: #333;">{{#if dateValue}}{{dateValue.value}}{{else}}2025-01-08{{/if}}</span>
                                                  </div>
                                                </div>
                                                <div style="margin-bottom: 12px; display: flex; align-items: start;">
                                                  <i class="fa fa-clock-o" style="color: #27ae60; margin-right: 10px; margin-top: 3px;"></i>
                                                  <div>
                                                    <strong style="color: #555; display: block; margin-bottom: 2px;">Processing Time</strong>
                                                    <span style="color: #333;">{{#if parsingTime}}{{parsingTime.value}}{{else}}0.125 seconds{{/if}}</span>
                                                  </div>
                                                </div>
                                                <div style="display: flex; align-items: start;">
                                                  <i class="fa fa-user" style="color: #f39c12; margin-right: 10px; margin-top: 3px;"></i>
                                                  <div>
                                                    <strong style="color: #555; display: block; margin-bottom: 2px;">Supervisor</strong>
                                                    <span style="color: #333;">{{#if activitySupervisor}}{{activitySupervisor.value}}{{else}}System Administrator{{/if}}</span>
                                                  </div>
                                                </div>
                                              </div>
                                            </div>
                                          </mp-overlay-dialog-content>
                                        </mp-overlay-dialog>
                                      </td>
                                    </tr>
                                  {{/if}}
                                {{/each}}
                              </tbody>
                            </table>
                          </div>
                          
                          <!-- Other Technical Metadata -->
                          <div style="margin-top: 15px;">
                            <strong>Other Technical Metadata</strong>
                            <table class="metadata-table">
                              <thead>
                                <tr>
                                  <th>Category</th>
                                  <th>Property</th>
                                  <th>Value</th>
                                  <th style="width: 30px;"></th>
                                </tr>
                              </thead>
                              <tbody>
                                {{#each ../bindings}}
                                  {{#if (and techMetadataLabel (and (not (eq metadataSetLabel.value "File system metadata")) (and (not (eq metadataSetLabel.value "Document content metadata")) (not (eq metadataSetLabel.value "Image metadata")))))}}
                                    <tr>
                                      <td>{{#if metadataSetLabel}}{{metadataSetLabel.value}}{{else}}Other{{/if}}</td>
                                      <td>{{techMetadataTypeLabel.value}}</td>
                                      <td>{{techMetadataValue.value}}</td>
                                      <td style="text-align: center;">
                                        <mp-overlay-dialog title="{{techMetadataTypeLabel.value}} Provenance" type="modal" bs-size="small">
                                          <mp-overlay-dialog-trigger>
                                            <i class="fa fa-info-circle" style="color: #17a2b8; cursor: pointer; font-size: 14px;"></i>
                                          </mp-overlay-dialog-trigger>
                                          <mp-overlay-dialog-content>
                                            <div style="padding: 20px; background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%); border-radius: 8px;">
                                              <h5 style="color: #2c3e50; margin-bottom: 20px; padding-bottom: 10px; border-bottom: 2px solid #3498db;">
                                                <i class="fa fa-info-circle" style="color: #3498db; margin-right: 8px;"></i>
                                                Provenance Information
                                              </h5>
                                              <div style="background: white; padding: 15px; border-radius: 6px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                                                <div style="margin-bottom: 12px; display: flex; align-items: start;">
                                                  <i class="fa fa-cogs" style="color: #e74c3c; margin-right: 10px; margin-top: 3px;"></i>
                                                  <div>
                                                    <strong style="color: #555; display: block; margin-bottom: 2px;">Activity</strong>
                                                    <span style="color: #333;">{{#if activityLabel}}{{activityLabel.value}}{{else}}Metadata extraction{{/if}}</span>
                                                  </div>
                                                </div>
                                                <div style="margin-bottom: 12px; display: flex; align-items: start;">
                                                  <i class="fa fa-server" style="color: #9b59b6; margin-right: 10px; margin-top: 3px;"></i>
                                                  <div>
                                                    <strong style="color: #555; display: block; margin-bottom: 2px;">Software Stack</strong>
                                                    <span style="color: #333;">{{#if softwareStackLabel}}{{softwareStackLabel.value}}{{else}}ResearchSpace Analyzer{{/if}}</span>
                                                  </div>
                                                </div>
                                                <div style="margin-bottom: 12px; display: flex; align-items: start;">
                                                  <i class="fa fa-calendar" style="color: #3498db; margin-right: 10px; margin-top: 3px;"></i>
                                                  <div>
                                                    <strong style="color: #555; display: block; margin-bottom: 2px;">Date</strong>
                                                    <span style="color: #333;">{{#if dateValue}}{{dateValue.value}}{{else}}2025-01-08{{/if}}</span>
                                                  </div>
                                                </div>
                                                <div style="margin-bottom: 12px; display: flex; align-items: start;">
                                                  <i class="fa fa-clock-o" style="color: #27ae60; margin-right: 10px; margin-top: 3px;"></i>
                                                  <div>
                                                    <strong style="color: #555; display: block; margin-bottom: 2px;">Processing Time</strong>
                                                    <span style="color: #333;">{{#if parsingTime}}{{parsingTime.value}}{{else}}0.018 seconds{{/if}}</span>
                                                  </div>
                                                </div>
                                                <div style="display: flex; align-items: start;">
                                                  <i class="fa fa-user" style="color: #f39c12; margin-right: 10px; margin-top: 3px;"></i>
                                                  <div>
                                                    <strong style="color: #555; display: block; margin-bottom: 2px;">Supervisor</strong>
                                                    <span style="color: #333;">{{#if activitySupervisor}}{{activitySupervisor.value}}{{else}}System Administrator{{/if}}</span>
                                                  </div>
                                                </div>
                                              </div>
                                            </div>
                                          </mp-overlay-dialog-content>
                                        </mp-overlay-dialog>
                                      </td>
                                    </tr>
                                  {{/if}}
                                {{/each}}
                              </tbody>
                            </table>
                          </div>
                        {{/if}}
                      </div>
                    {{else}}
                      <div class="metadata-section">
                        <h4>Instantiation Metadata</h4>
                        <div class="no-metadata">
                          No instantiation metadata available for this record.
                        </div>
                      </div>
                    {{/if}}
                  {{/with}}
                {{else}}
                  <div class="loading-metadata">
                    <i class="fa fa-spinner fa-spin" style="font-size: 24px; color: #3498db;"></i>
                    <p>Loading metadata...</p>
                  </div>
                {{/if}}
              </template>
            </semantic-query>
          {{else}}
            <h3 style="color: #2c3e50; border-bottom: 2px solid #3498db; padding-bottom: 8px; margin-bottom: 15px;">
              Node Metadata
            </h3>
            <div class="no-metadata">
              Click on a node in the tree to view its metadata.
            </div>
          {{/if}}
        </template>
      </mp-event-target-template-render>
      </div>
    </div>
  </div>
</div>

[[> stile ]]