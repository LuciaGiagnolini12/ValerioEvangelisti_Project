<div class="page full-height-page">
  <!-- Page Header -->
  <div class="page-header">
  </div>

  <!-- Two-column layout -->
  <div class="content-columns">
    <!-- Left column: Semantic Tree Advanced -->
    <div class="tree-column">
      <h3>Archival Structure</h3>
      <p>Explore the born-digital archive and navigate through its hierarchical structure.</p>

      <div class="tree-container">
      <style>
        .Tree--tree {
          max-height: calc(100vh - 200px) !important;
          overflow-y: auto !important;
          overflow-x: hidden !important;
        }
        
        .Tree--tree::-webkit-scrollbar {
          width: 8px;
        }
        
        .Tree--tree::-webkit-scrollbar-track {
          background: #f1f1f1;
          border-radius: 4px;
        }
        
        .Tree--tree::-webkit-scrollbar-thumb {
          background: #888;
          border-radius: 4px;
        }
        
        .Tree--tree::-webkit-scrollbar-thumb:hover {
          background: #555;
        }
      </style>
      <semantic-tree-advanced 
        id="evangelisti-tree-advanced"
        show-tree-lines="true"
        tree-line-style="dotted"
        search-placeholder="Search archive nodes..."
        search-query="
          SELECT DISTINCT ?node WHERE {
            GRAPH <http://ficlit.unibo.it/ArchivioEvangelisti/structure/RS1_RS1> {
              ?node rdfs:label ?label .
              FILTER(CONTAINS(LCASE(?label), LCASE(&quot;$__searchText__&quot;)))
            }
          }
        "
        filter-options='[
        {
          "label": "Hide anonymized information",
          "description": "Hide files marked as having omitted information (folders are kept to show non-omitted children)",
          "condition": "PREFIX bodi: <http://w3id.org/bodi#> PREFIX rico: <https://www.ica.org/standards/RiC/ontology#> SELECT ?node WHERE { ?node bodi:redactedInformation \"yes\" . FILTER NOT EXISTS { ?node rico:includesOrIncluded ?child } }",
          "defaultChecked": false
        }
        ]'
        related-node-criteria='[
          {
            "label": "Same Hash",
            "icon": "fa fa-copy",
            "query": "PREFIX rico: <https://www.ica.org/standards/RiC/ontology#> PREFIX bodi: <http://w3id.org/bodi#> SELECT DISTINCT ?node WHERE { <$__nodeIri__> rico:hasOrHadInstantiation ?inst1 . ?inst1 bodi:hasSameHashCodeAs ?inst2 . ?node rico:hasOrHadInstantiation ?inst2 . FILTER(?node != <$__nodeIri__>) }",
            "description": "Find all records with the same file hash (duplicate files)"
          }
        ]'
        query="
          SELECT DISTINCT ?parent ?node ?label ?title ?structuralTitle ?hasChildren (COUNT(DISTINCT ?child) as ?childCount) ?isRoot ?fileType WHERE {
            # Load RS1 and its three parts dynamically using dcterms:hasPart
            VALUES ?parent { <http://ficlit.unibo.it/ArchivioEvangelisti/structure/RS1> }
            ?parent <http://purl.org/dc/terms/hasPart> ?node .
            
            # Check if the corresponding data node (without /structure/) has children
            BIND(IRI(REPLACE(STR(?node), &quot;/structure&quot;, &quot;&quot;)) AS ?dataNode)
            OPTIONAL {
              ?dataNode <https://www.ica.org/standards/RiC/ontology#includesOrIncluded> ?child .
            }
            BIND(EXISTS { 
              BIND(IRI(REPLACE(STR(?node), &quot;/structure&quot;, &quot;&quot;)) AS ?dn)
              ?dn <https://www.ica.org/standards/RiC/ontology#includesOrIncluded> ?anyChild 
            } AS ?hasChildren)
            
            # Mark RS1 as root
            BIND(IF(?parent = <http://ficlit.unibo.it/ArchivioEvangelisti/structure/RS1>, &quot;true&quot;, &quot;false&quot;) AS ?isRoot)
            
            # Set custom label for RS1
            BIND(IF(?parent = <http://ficlit.unibo.it/ArchivioEvangelisti/structure/RS1>, &quot;Born-Digital Materials&quot;, ?tempLabel) AS ?label)
            OPTIONAL { 
              ?parent rdfs:label ?tempLabel 
            }
            
            # Fetch labels for nodes
            OPTIONAL { ?node rdfs:label ?tempTitle }
            
            # Set custom titles for specific nodes (RS1_RS1, RS1_RS2, RS1_RS3)
            BIND(
              IF(?node = <http://ficlit.unibo.it/ArchivioEvangelisti/structure/RS1_RS1>, &quot;Primary Hard Drive&quot;,
              IF(?node = <http://ficlit.unibo.it/ArchivioEvangelisti/structure/RS1_RS2>, &quot;External Hard Drive&quot;,
              IF(?node = <http://ficlit.unibo.it/ArchivioEvangelisti/structure/RS1_RS3>, &quot;Floppy Disks Collection&quot;,
              ?tempTitle)))
            AS ?title)
            
            # For structural nodes, fetch the isRelatedTo value
            OPTIONAL { ?node <https://www.ica.org/standards/RiC/ontology#isRelatedTo> ?structuralTitle }
            
            # Get file type from technical metadata
            OPTIONAL {
              ?dataNode <https://www.ica.org/standards/RiC/ontology#hasOrHadInstantiation> ?inst .
              ?inst <http://w3id.org/bodi#hasTechnicalMetadata> ?techMeta .
              ?techMeta <http://w3id.org/bodi#hasTechnicalMetadataType> <http://ficlit.unibo.it/ArchivioEvangelisti/system_tmtype_0001> .
              ?techMeta <http://www.w3.org/1999/02/22-rdf-syntax-ns#value> ?fileType .
            }
          } GROUP BY ?parent ?node ?label ?title ?structuralTitle ?hasChildren ?isRoot ?fileType
        "
        expand-query="
          SELECT DISTINCT ?parent ?node ?label ?title ?hasChildren (COUNT(DISTINCT ?child) as ?childCount) ?fileType WHERE {
            # Convert /structure/ IRI to data IRI by removing &quot;/structure&quot;
            BIND(IRI(REPLACE(STR(<{{clickedNode}}>), &quot;/structure&quot;, &quot;&quot;)) AS ?dataNode)
            
            # Get children using includesOrIncluded
            ?dataNode <https://www.ica.org/standards/RiC/ontology#includesOrIncluded> ?node .
            BIND(<{{clickedNode}}> as ?parent)
            
            # Check for grandchildren
            OPTIONAL { ?node <https://www.ica.org/standards/RiC/ontology#includesOrIncluded> ?child . }
            BIND(EXISTS { ?node <https://www.ica.org/standards/RiC/ontology#includesOrIncluded> ?anyChild . } AS ?hasChildren)
            
            # Fetch labels from default graph
            OPTIONAL { ?parent rdfs:label ?label }
            OPTIONAL { ?node rdfs:label ?title }
            
            # Get file type from technical metadata
            OPTIONAL {
              ?node <https://www.ica.org/standards/RiC/ontology#hasOrHadInstantiation> ?inst .
              ?inst <http://w3id.org/bodi#hasTechnicalMetadata> ?techMeta .
              ?techMeta <http://w3id.org/bodi#hasTechnicalMetadataType> <http://ficlit.unibo.it/ArchivioEvangelisti/system_tmtype_0001> .
              ?techMeta <http://www.w3.org/1999/02/22-rdf-syntax-ns#value> ?fileType .
            }
          } GROUP BY ?parent ?node ?label ?title ?hasChildren ?fileType
        "
        path-to-root-query="
          SELECT DISTINCT ?ancestor WHERE {
            GRAPH <http://ficlit.unibo.it/ArchivioEvangelisti/structure/RS1_RS1> {
              <$__node__> (<https://www.ica.org/standards/RiC/ontology#isOrWasPartOf>)* ?ancestor .
            }
          }
        "
      roots='["http://ficlit.unibo.it/ArchivioEvangelisti/structure/RS1"]'
      keys-opened='["http://ficlit.unibo.it/ArchivioEvangelisti/structure/RS1"]'
      has-children-binding="hasChildren"
      enable-cache="true"
      loading-template='<i class="fa fa-spinner fa-spin" style="color: #3498db; margin-left: 8px;"></i>'
      sort-options='[
        {"label": "Title", "binding": "title", "type": "string"},
        {"label": "Node IRI", "binding": "node", "type": "string"},
        {"label": "Number of Children", "binding": "childCount", "type": "number", "defaultDirection": "desc"}
      ]'
      initial-sort='{"binding": "node", "direction": "asc"}'
      show-sort-controls="true"
      tuple-template='{{> nodeTemplate}}'>
        
        <template id='nodeTemplate'>
          <div>
            {{#if (eq expandSiblings.value "true")}}
              <!-- Expand siblings button -->
              <div class="siblingExpandButton">
                <i class="fa fa-plus-circle" style="margin-right: 5px;"></i>
                Expand {{hiddenCount.value}} siblings...
              </div>
            {{else}}
              <!-- Regular node -->
              <mp-event-trigger type='Component.TemplateUpdate' data='{"iri": "{{node.value}}", "hasChildren": "{{hasChildren.value}}", "childCount": "{{childCount.value}}"}' targets='["node-details-advanced"]'>
                <div class="node-content" style="cursor: pointer; padding: 5px; border-radius: 4px; transition: background-color 0.2s; margin-bottom: 3px;">
                  <div style="display: flex; align-items: center;">
                    {{#if (eq node.value "http://ficlit.unibo.it/ArchivioEvangelisti/structure/RS1")}}
                      <!-- Root node - use home icon -->
                      <i class="fa fa-home" style="margin-right: 8px; color: #777; font-size: 1.2em;"></i>
                      <span style="font-size: 0.8em; color: #777; margin-right: 5px;">({{childCount.value}})</span>
                    {{else if structuralTitle.value}}
                      <!-- Structural node - use archive icon -->
                      <i class="fa fa-archive" style="margin-right: 8px; color:#E86A33;"></i>
                      <span style="font-size: 0.8em; color: #777; margin-right: 5px;">({{childCount.value}})</span>
                    {{else if (eq fileType.value "directory")}}
                      <!-- Node explicitly marked as directory -->
                      <i class="fa fa-folder" style="margin-right: 8px; color: #d4c7b2;"></i>
                      <span style="font-size: 0.8em; color: #777; margin-right: 5px;">({{childCount.value}})</span>
                    {{else if (eq fileType.value "file")}}
                      <!-- Node explicitly marked as file -->
                      <i class="fa fa-file-text-o" style="margin-right: 8px; color: #777;"></i>
                    {{else if (eq hasChildren.value "true")}}
                      <!-- Fallback: has children = folder -->
                      <i class="fa fa-folder" style="margin-right: 8px; color: #d4c7b2;"></i>
                      <span style="font-size: 0.8em; color: #777; margin-right: 5px;">({{childCount.value}})</span>
                    {{else}}
                      <!-- Fallback: no children = file -->
                      <i class="fa fa-file-text-o" style="margin-right: 8px; color: #777;"></i>
                    {{/if}}
                    
                    <div>
                      {{#if (eq node.value "http://ficlit.unibo.it/ArchivioEvangelisti/structure/RS1")}}
                        <!-- Root node - show custom name -->
                        <a href="{{node.value}}" target="_blank" style="font-weight: bold; color: #333; text-decoration: none; font-size: 1.1em;">Born-Digital Materials</a>
                      {{else if (eq node.value "http://ficlit.unibo.it/ArchivioEvangelisti/structure/RS1_RS1")}}
                        <!-- RS1_RS1 custom title -->
                        <a href="{{node.value}}" target="_blank" style="font-weight: bold; color: #333; text-decoration: none;">{{title.value}}</a>
                      {{else if (eq node.value "http://ficlit.unibo.it/ArchivioEvangelisti/structure/RS1_RS2")}}
                        <!-- RS1_RS2 custom title -->
                        <a href="{{node.value}}" target="_blank" style="font-weight: bold; color: #333; text-decoration: none;">{{title.value}}</a>
                      {{else if (eq node.value "http://ficlit.unibo.it/ArchivioEvangelisti/structure/RS1_RS3")}}
                        <!-- RS1_RS3 custom title -->
                        <a href="{{node.value}}" target="_blank" style="font-weight: bold; color: #333; text-decoration: none;">{{title.value}}</a>
                      {{else if structuralTitle.value}}
                        <!-- For other structural nodes, show the isRelatedTo value -->
                        <a href="{{node.value}}" target="_blank" style="font-weight: bold; color: #333; text-decoration: none;">{{structuralTitle.value}}</a>
                      {{else if title.value}}
                        <a href="{{node.value}}" target="_blank" style="font-weight: bold; color: #333; text-decoration: none;">{{title.value}}</a>
                      {{else}}
                        <a href="{{node.value}}" target="_blank" style="font-weight: bold; color: #333; text-decoration: none;">{{node.value}}</a>
                      {{/if}}
                      <div style="font-size: 0.8em; color: #777;">{{node.value}}</div>
                    </div>
                  </div>
                </div>
              </mp-event-trigger>
            {{/if}}
          </div>
        </template>
      </semantic-tree-advanced>
      </div>
    </div>
    
    <!-- Right column: Node Details with Metadata -->
    <div class="metadata-column">
      <div class="sticky-metadata-container">
        <mp-event-target-template-render id='node-details-advanced' template='{{> detailsTemplate}}'>
        <template id='detailsTemplate'>
          {{#if iri}}
            <!-- Fetch metadata for the selected node -->
            <semantic-query 
              query='
                PREFIX rico: <https://www.ica.org/standards/RiC/ontology#>
                PREFIX bodi: <http://w3id.org/bodi#>
                PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
                PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
                
                SELECT ?node ?nodeLabel ?nodeType 
                       ?title ?titleLabel
                       ?creationDate ?creationDateLabel ?creationDateNormalized
                       ?modificationDate ?modificationDateLabel ?modificationDateNormalized
                       (SAMPLE(?inst) as ?instantiation) 
                       (SAMPLE(?instLabel) as ?instLabel) 
                       (SAMPLE(?instType) as ?instType)
                       (SAMPLE(?techDescValue) as ?techDescValue)
                       ?techMetadataLabel ?techMetadataValue 
                       (SAMPLE(?techMetadataType) as ?techMetadataType)
                       (SAMPLE(?techMetadataTypeLabel) as ?techMetadataTypeLabel)
                       (SAMPLE(?metadataSet) as ?metadataSet)
                       (SAMPLE(?metadataSetLabel) as ?metadataSetLabel)
                       (SAMPLE(?activity) as ?activity) 
                       (SAMPLE(?activityLabel) as ?activityLabel) 
                       (SAMPLE(?softwareStackLabel) as ?softwareStackLabel) 
                       (SAMPLE(?dateValue) as ?dateValue) 
                       (SAMPLE(?parsingTime) as ?parsingTime) 
                       (SAMPLE(?activitySupervisor) as ?activitySupervisor)
                WHERE {
                  BIND(<{{iri}}> as ?node)
                  
                  OPTIONAL { ?node rdfs:label ?nodeLabel }
                  OPTIONAL { ?node a ?nodeType }
                  
                  OPTIONAL { 
                    ?node rico:hasOrHadTitle ?title .
                    ?title rdfs:label ?titleLabel .
                  }
                  
                  OPTIONAL { 
                    ?node rico:hasCreationDate ?creationDate .
                    OPTIONAL { ?creationDate rico:expressedDate ?creationDateLabel }
                    OPTIONAL { ?creationDate rico:normalizedDateValue ?creationDateNormalized }
                  }
                  
                  OPTIONAL { 
                    ?node rico:hasModificationDate ?modificationDate .
                    OPTIONAL { ?modificationDate rico:expressedDate ?modificationDateLabel }
                    OPTIONAL { ?modificationDate rico:normalizedDateValue ?modificationDateNormalized }
                  }
                  
                  OPTIONAL {
                    ?node rico:hasOrHadInstantiation ?inst .
                    OPTIONAL { ?inst rdfs:label ?instLabel }
                    OPTIONAL { ?inst rico:type ?instType }
                    
                    OPTIONAL {
                      ?inst bodi:hasTechnicalDescription ?techDesc .
                      ?techDesc rdf:value ?techDescValue .
                    }
                    
                    OPTIONAL {
                      ?inst bodi:hasTechnicalMetadata ?techMetadata .
                      ?techMetadata rdfs:label ?techMetadataLabel .
                      ?techMetadata rdf:value ?techMetadataValue .
                      
                      OPTIONAL {
                        ?techMetadata bodi:hasTechnicalMetadataType ?techMetadataType .
                        ?techMetadataType rdfs:label ?techMetadataTypeLabel .
                        OPTIONAL {
                          ?techMetadataType rico:isOrWasPartOf ?metadataSet .
                          ?metadataSet rdfs:label ?metadataSetLabel .
                        }
                      }
                      
                      OPTIONAL {
                        ?techMetadata bodi:generatedBy ?activity .
                        OPTIONAL { ?activity rdfs:label ?activityLabel }
                        OPTIONAL {
                          ?activity rico:isOrWasPerformedBy ?softwarestack .
                          ?softwarestack rdf:type bodi:SoftwareStack .
                          ?softwarestack rdfs:label ?softwareStackLabel .
                        }
                        OPTIONAL {
                          ?activity rico:occurredAtDate ?date .
                          ?date rico:expressedDate ?dateValue .
                        }
                        OPTIONAL {
                          ?activity rico:hasExtent ?extent .
                          ?extent rdf:value ?parsingTime .
                        }
                        OPTIONAL {
                          ?activity bodi:hasOrHadSupervisor ?person .
                          ?person rdfs:label ?activitySupervisor .
                        }
                      }
                    }
                  }
                }
                GROUP BY ?node ?nodeLabel ?nodeType 
                         ?title ?titleLabel
                         ?creationDate ?creationDateLabel ?creationDateNormalized
                         ?modificationDate ?modificationDateLabel ?modificationDateNormalized
                         ?techMetadataLabel ?techMetadataValue
                ORDER BY ?metadataSetLabel ?techMetadataTypeLabel ?techMetadataLabel
              '
              template='{{> metadataDisplay}}'
            >
              <template id='metadataDisplay'>
                {{#if bindings.length}}
                  {{#with bindings.[0]}}
                    <!-- Dynamic Title with Icon and Child Count -->
              <h3 style="color: #2c3e50; border-bottom: 2px solid #E86A33; padding-bottom: 8px; margin-bottom: 8px;">
                {{#if (eq ../../hasChildren "true")}}
                  <i class="fa fa-folder" style="color: #d4c7b2; margin-right: 8px;"></i>
                {{else}}
                  <i class="fa fa-file-text-o" style="color: #777; margin-right: 8px;"></i>
                {{/if}}
                
                {{#if (eq ../iri "http://ficlit.unibo.it/ArchivioEvangelisti/structure/RS1_RS1")}}
                  Primary Hard Drive 
                {{else if (eq ../iri "http://ficlit.unibo.it/ArchivioEvangelisti/structure/RS1_RS2")}}
                  External Hard Drive
                {{else if (eq ../iri "http://ficlit.unibo.it/ArchivioEvangelisti/structure/RS1_RS3")}}
                  Floppy Disks Collection
                {{else if nodeLabel}}
                  {{nodeLabel.value}}
                {{else}}
                  {{../iri}}
                {{/if}}
                
                {{#if (eq ../../hasChildren "true")}}
                  ({{../../childCount}})
                {{/if}}
              </h3>
                    
                    <!-- IRI in grey -->
                    <div style="font-size: 0.9em; color: #888; margin-bottom: 15px; word-break: break-all;">
                      {{node.value}}
                    </div>
                    
                    <!-- Technical Description (if available) -->
                    {{#if techDescValue}}
                      <div class="technical-description">
                        <strong>Technical Description:</strong> {{techDescValue.value}}
                      </div>
                    {{/if}}
                
                    <!-- Check if this is a special node -->
                    {{#if (or (eq ../iri "http://ficlit.unibo.it/ArchivioEvangelisti/structure/RS1_RS1") 
                              (or (eq ../iri "http://ficlit.unibo.it/ArchivioEvangelisti/structure/RS1_RS2") 
                                  (eq ../iri "http://ficlit.unibo.it/ArchivioEvangelisti/structure/RS1_RS3")))}}
                      
                      <!-- Custom Information for RS1_RS1, RS1_RS2, RS1_RS3 -->
                      <div class="metadata-section" style="background-color: #f5eddc; border-left: 4px solid #d4c7b2;">
                        <h4 style="color: #856404; border-bottom: 2px solid #d4c7b2;">
                          <i class="fa fa-star" style="margin-right: 8px;"></i>
                          Directory Information
                        </h4>
              
                        {{#if (eq ../iri "http://ficlit.unibo.it/ArchivioEvangelisti/structure/RS1_RS1")}}
                        <div class="metadata-field">
                          <span class="metadata-label">Directory Type:</span>
                          <span class="metadata-value">Materials originally stored on the hard drive of Evangelisti's desktop computer</span>
                        </div>
                        <div class="metadata-field">
                          <span class="metadata-label">Description:</span>
                          <span class="metadata-value">
                            The content of the hard drive from Evangelisti's desktop computer documents more than three decades of activity, tracing the evolution of his intellectual and literary production, digital organization, and creative experimentation. The collection comprises 65,448 items (approximately 674 GB) related to creative, academic, and personal spheres, including narrative drafts, research materials, high-definition scans, personal media, system backups, software, and email correspondence.
                          </span>
                        </div>
                      {{else if (eq ../iri "http://ficlit.unibo.it/ArchivioEvangelisti/structure/RS1_RS2")}}
                        <div class="metadata-field">
                          <span class="metadata-label">Collection Type:</span>
                          <span class="metadata-value">Materials originally stored on the external hard drive used by Evangelisti</span>
                        </div>
                        <div class="metadata-field">
                          <span class="metadata-label">Description:</span>
                          <span class="metadata-value">
                            Materials contained in the external hard drive: a curated collection of key documents, digital collections, and research resources, representing significant creative and intellectual work. The archive comprises 19,817 items totaling 1.53 TB and was likely used as a backup of essential data from the primary desktop.
                          </span>
                        </div>
                      {{else if (eq ../iri "http://ficlit.unibo.it/ArchivioEvangelisti/structure/RS1_RS3")}}
                        <div class="metadata-field">
                          <span class="metadata-label">Collection Type:</span>
                          <span class="metadata-value">Materials originally stored on floppy disks</span>
                        </div>
                        <div class="metadata-field">
                          <span class="metadata-label">Description:</span>
                          <span class="metadata-value">
                            This collection of floppy disks (2,214 items, 4.85 GB) constitutes the earliest digital segment of Evangelisti's archive. It includes drafts of early novels, initial issues of Carmilla, BBS messages, personal notes, and software applications. The collection offers unique insight into his early digital practices, combining textual production, software use, and engagement with underground computing and gaming culture.
                          </span>
                        </div>
                      {{/if}}

              
                        <!-- Additional Properties Table -->
                        <div style="margin-top: 15px;">
                          <strong>Additional Properties</strong>
                          <table class="metadata-table">
                            <thead>
                              <tr>
                                <th>Property</th>
                                <th>Value</th>
                              </tr>
                            </thead>
                            <tbody>
                              {{#if (eq ../iri "http://ficlit.unibo.it/ArchivioEvangelisti/structure/RS1_RS1")}}
                                <tr>
                                  <td>Items Count</td>
                                  <td>65.448 items</td>
                                </tr>
                                <tr>
                                  <td>Contents Date Range</td>
                                  <td>1990-2023</td>
                                </tr>
                                <tr>
                                  <td>Total Size</td>
                                  <td>674,36 GB</td>
                                </tr>
                                <tr>
                                  <td>Current Medium</td>
                                  <td>
                                    Server Dell PowerEdge R7525
                                    <mp-overlay-dialog title="Current Medium Derivation Info" type="modal" bs-size="medium">
                                      <mp-overlay-dialog-trigger>
                                        <i class="fa fa-info-circle" style="color: #17a2b8; cursor: pointer; margin-left: 5px; font-size: 14px;"></i>
                                      </mp-overlay-dialog-trigger>
                                      <mp-overlay-dialog-content>
                                        <div style="padding: 20px; background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%); border-radius: 8px;">
                                          <h5 style="color: #2c3e50; margin-bottom: 20px; padding-bottom: 10px; border-bottom: 2px solid #3498db;">
                                            <i class="fa fa-calendar" style="color: #3498db; margin-right: 8px;"></i>
                                            Derivation Information
                                          </h5>
                                          <div style="background: white; padding: 15px; border-radius: 6px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                                            <div style="margin-bottom: 12px; display: flex; align-items: start;">
                                              <i class="fa fa-calendar-check-o" style="color: #3498db; margin-right: 10px; margin-top: 3px;"></i>
                                              <div>
                                                <strong style="color: #555; display: block; margin-bottom: 2px;">Transfer Date</strong>
                                                <span style="color: #333;">2025-08-06</span>
                                              </div>
                                            </div>
                                            <div style="margin-bottom: 12px; display: flex; align-items: start;">
                                              <i class="fa fa-arrow-right" style="color: #27ae60; margin-right: 10px; margin-top: 3px;"></i>
                                              <div>
                                                <strong style="color: #555; display: block; margin-bottom: 2px;">From</strong>
                                                <span style="color: #333;">Samsung Portable SSD T7</span>
                                              </div>
                                            </div>
                                            <div style="margin-bottom: 12px; display: flex; align-items: start;">
                                              <i class="fa fa-user" style="color: #f39c12; margin-right: 10px; margin-top: 3px;"></i>
                                              <div>
                                                <strong style="color: #555; display: block; margin-bottom: 2px;">Performed By</strong>
                                                <span style="color: #333;">Associazione Valerio Evangelisti - Il Sol dell'Avvenire</span>
                                              </div>
                                            </div>
                                            <div style="display: flex; align-items: start;">
                                              <i class="fa fa-file-text-o" style="color: #9b59b6; margin-right: 10px; margin-top: 3px;"></i>
                                              <div>
                                                <strong style="color: #555; display: block; margin-bottom: 2px;">Notes</strong>
                                                <span style="color: #333;">Migrated to Server Dell PowerEdge R7525 to perform structure and metadata extraction</span>
                                              </div>
                                            </div>
                                          </div>
                                        </div>
                                      </mp-overlay-dialog-content>
                                    </mp-overlay-dialog>
                                  </td>
                                </tr>
                                <tr>
                                  <td>Previous Medium</td>
                                  <td>
                                    Samsung Portable SSD T7 1 TB USB tipo-C 3.2 Gen 2
                                    <mp-overlay-dialog title="Previous Medium Derivation Info" type="modal" bs-size="medium">
                                      <mp-overlay-dialog-trigger>
                                        <i class="fa fa-info-circle" style="color: #17a2b8; cursor: pointer; margin-left: 5px; font-size: 14px;"></i>
                                      </mp-overlay-dialog-trigger>
                                      <mp-overlay-dialog-content>
                                        <div style="padding: 20px; background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%); border-radius: 8px;">
                                          <h5 style="color: #2c3e50; margin-bottom: 20px; padding-bottom: 10px; border-bottom: 2px solid #3498db;">
                                            <i class="fa fa-calendar" style="color: #3498db; margin-right: 8px;"></i>
                                            Derivation Information
                                          </h5>
                                          <div style="background: white; padding: 15px; border-radius: 6px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                                            <div style="margin-bottom: 12px; display: flex; align-items: start;">
                                              <i class="fa fa-calendar-check-o" style="color: #3498db; margin-right: 10px; margin-top: 3px;"></i>
                                              <div>
                                                <strong style="color: #555; display: block; margin-bottom: 2px;">Transfer Date</strong>
                                                <span style="color: #333;">August 2024</span>
                                              </div>
                                            </div>
                                            <div style="margin-bottom: 12px; display: flex; align-items: start;">
                                              <i class="fa fa-arrow-right" style="color: #27ae60; margin-right: 10px; margin-top: 3px;"></i>
                                              <div>
                                                <strong style="color: #555; display: block; margin-bottom: 2px;">From</strong>
                                                <span style="color: #333;">Unknown Microsoft Windows PC</span>
                                              </div>
                                            </div>
                                            <div style="margin-bottom: 12px; display: flex; align-items: start;">
                                              <i class="fa fa-user" style="color: #f39c12; margin-right: 10px; margin-top: 3px;"></i>
                                              <div>
                                                <strong style="color: #555; display: block; margin-bottom: 2px;">Performed By</strong>
                                                <span style="color: #333;">Valerio Evangelisti's heirs</span>
                                              </div>
                                            </div>
                                            <div style="display: flex; align-items: start;">
                                              <i class="fa fa-file-text-o" style="color: #9b59b6; margin-right: 10px; margin-top: 3px;"></i>
                                              <div>
                                                <strong style="color: #555; display: block; margin-bottom: 2px;">Notes</strong>
                                                <span style="color: #333;">First transfer from the original medium to portable storage device</span>
                                              </div>
                                            </div>
                                          </div>
                                        </div>
                                      </mp-overlay-dialog-content>
                                    </mp-overlay-dialog>
                                  </td>
                                </tr>
                                <tr>
                                  <td>Original Medium</td>
                                  <td>
                                    Unknown Microsoft Windows PC
                                    <mp-overlay-dialog title="Original Medium Info" type="modal" bs-size="medium">
                                      <mp-overlay-dialog-trigger>
                                        <i class="fa fa-info-circle" style="color: #17a2b8; cursor: pointer; margin-left: 5px; font-size: 14px;"></i>
                                      </mp-overlay-dialog-trigger>
                                      <mp-overlay-dialog-content>
                                        <div style="padding: 20px; background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%); border-radius: 8px;">
                                          <h5 style="color: #2c3e50; margin-bottom: 20px; padding-bottom: 10px; border-bottom: 2px solid #3498db;">
                                            <i class="fa fa-desktop" style="color: #3498db; margin-right: 8px;"></i>
                                            Original Medium Information
                                          </h5>
                                          <div style="background: white; padding: 15px; border-radius: 6px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                                            <div style="margin-bottom: 12px; display: flex; align-items: start;">
                                              <i class="fa fa-desktop" style="color: #9b59b6; margin-right: 10px; margin-top: 3px;"></i>
                                              <div>
                                                <strong style="color: #555; display: block; margin-bottom: 2px;">System</strong>
                                                <span style="color: #333;">Microsoft Windows (version unknown)</span>
                                              </div>
                                            </div>
                                            <div style="display: flex; align-items: start;">
                                              <i class="fa fa-file-text-o" style="color: #e74c3c; margin-right: 10px; margin-top: 3px;"></i>
                                              <div>
                                                <strong style="color: #555; display: block; margin-bottom: 2px;">Notes</strong>
                                                <span style="color: #333;">Original creation device. Exact specifications unknown. Files created and modified over multiple years on author's personal computer.</span>
                                              </div>
                                            </div>
                                          </div>
                                        </div>
                                      </mp-overlay-dialog-content>
                                    </mp-overlay-dialog>
                                  </td>
                                </tr>
                              {{else if (eq ../iri "http://ficlit.unibo.it/ArchivioEvangelisti/structure/RS1_RS2")}}
                                <tr>
                                  <td>Items Count</td>
                                  <td>19.817 items</td>
                                </tr>
                                <tr>
                                  <td>Contents Date Range</td>
                                  <td>1985-2015</td>
                                </tr>
                                <tr>
                                  <td>Total Size</td>
                                  <td>1,53 TB</td>
                                </tr>
                                <tr>
                                  <td>Current Medium</td>
                                  <td>
                                    Server Dell PowerEdge R7525
                                    <mp-overlay-dialog title="Current Medium Derivation Info" type="modal" bs-size="medium">
                                      <mp-overlay-dialog-trigger>
                                        <i class="fa fa-info-circle" style="color: #17a2b8; cursor: pointer; margin-left: 5px; font-size: 14px;"></i>
                                      </mp-overlay-dialog-trigger>
                                      <mp-overlay-dialog-content>
                                        <div style="padding: 20px; background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%); border-radius: 8px;">
                                          <h5 style="color: #2c3e50; margin-bottom: 20px; padding-bottom: 10px; border-bottom: 2px solid #3498db;">
                                            <i class="fa fa-calendar" style="color: #3498db; margin-right: 8px;"></i>
                                            Derivation Information
                                          </h5>
                                          <div style="background: white; padding: 15px; border-radius: 6px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                                            <div style="margin-bottom: 12px; display: flex; align-items: start;">
                                              <i class="fa fa-calendar-check-o" style="color: #3498db; margin-right: 10px; margin-top: 3px;"></i>
                                              <div>
                                                <strong style="color: #555; display: block; margin-bottom: 2px;">Transfer Date</strong>
                                                <span style="color: #333;">2025-08-06</span>
                                              </div>
                                            </div>
                                            <div style="margin-bottom: 12px; display: flex; align-items: start;">
                                              <i class="fa fa-arrow-right" style="color: #27ae60; margin-right: 10px; margin-top: 3px;"></i>
                                              <div>
                                                <strong style="color: #555; display: block; margin-bottom: 2px;">From</strong>
                                                <span style="color: #333;">Samsung Portable SSD T7</span>
                                              </div>
                                            </div>
                                            <div style="margin-bottom: 12px; display: flex; align-items: start;">
                                              <i class="fa fa-user" style="color: #f39c12; margin-right: 10px; margin-top: 3px;"></i>
                                              <div>
                                                <strong style="color: #555; display: block; margin-bottom: 2px;">Performed By</strong>
                                                <span style="color: #333;">Associazione Valerio Evangelisti - Il Sol dell'Avvenire</span>
                                              </div>
                                            </div>
                                            <div style="display: flex; align-items: start;">
                                              <i class="fa fa-file-text-o" style="color: #9b59b6; margin-right: 10px; margin-top: 3px;"></i>
                                              <div>
                                                <strong style="color: #555; display: block; margin-bottom: 2px;">Notes</strong>
                                                <span style="color: #333;">Migrated to Server Dell PowerEdge R7525 to perform structure and metadata extraction</span>
                                              </div>
                                            </div>
                                          </div>
                                        </div>
                                      </mp-overlay-dialog-content>
                                    </mp-overlay-dialog>
                                  </td>
                                </tr>
                                <tr>
                                  <td>Previous Medium</td>
                                  <td>
                                    Samsung Portable SSD T7 1 TB USB tipo-C 3.2 Gen 2
                                    <mp-overlay-dialog title="Previous Medium Derivation Info" type="modal" bs-size="medium">
                                      <mp-overlay-dialog-trigger>
                                        <i class="fa fa-info-circle" style="color: #17a2b8; cursor: pointer; margin-left: 5px; font-size: 14px;"></i>
                                      </mp-overlay-dialog-trigger>
                                      <mp-overlay-dialog-content>
                                        <div style="padding: 20px; background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%); border-radius: 8px;">
                                          <h5 style="color: #2c3e50; margin-bottom: 20px; padding-bottom: 10px; border-bottom: 2px solid #3498db;">
                                            <i class="fa fa-calendar" style="color: #3498db; margin-right: 8px;"></i>
                                            Derivation Information
                                          </h5>
                                          <div style="background: white; padding: 15px; border-radius: 6px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                                            <div style="margin-bottom: 12px; display: flex; align-items: start;">
                                              <i class="fa fa-calendar-check-o" style="color: #3498db; margin-right: 10px; margin-top: 3px;"></i>
                                              <div>
                                                <strong style="color: #555; display: block; margin-bottom: 2px;">Transfer Date</strong>
                                                <span style="color: #333;">August 2024</span>
                                              </div>
                                            </div>
                                            <div style="margin-bottom: 12px; display: flex; align-items: start;">
                                              <i class="fa fa-arrow-right" style="color: #27ae60; margin-right: 10px; margin-top: 3px;"></i>
                                              <div>
                                                <strong style="color: #555; display: block; margin-bottom: 2px;">From</strong>
                                                <span style="color: #333;">Western Digital WDBACW0020HBK-01 My Book 2TB USB 3.0 Series External Hard Drive</span>
                                              </div>
                                            </div>
                                            <div style="margin-bottom: 12px; display: flex; align-items: start;">
                                              <i class="fa fa-user" style="color: #f39c12; margin-right: 10px; margin-top: 3px;"></i>
                                              <div>
                                                <strong style="color: #555; display: block; margin-bottom: 2px;">Performed By</strong>
                                                <span style="color: #333;">Associazione Valerio Evangelisti - Il Sol dell'Avvenire</span>
                                              </div>
                                            </div>
                                            <div style="display: flex; align-items: start;">
                                              <i class="fa fa-file-text-o" style="color: #9b59b6; margin-right: 10px; margin-top: 3px;"></i>
                                              <div>
                                                <strong style="color: #555; display: block; margin-bottom: 2px;">Notes</strong>
                                                <span style="color: #333;">First transfer from the original medium to portable storage device</span>
                                              </div>
                                            </div>
                                          </div>
                                        </div>
                                      </mp-overlay-dialog-content>
                                    </mp-overlay-dialog>
                                  </td>
                                </tr>
                                <tr>
                                  <td>Original Medium</td>
                                  <td>
                                    Western Digital WDBACW0020HBK-01 My Book 2TB USB 3.0 Series External Hard Drive
                                    <mp-overlay-dialog title="Original Medium Info" type="modal" bs-size="medium">
                                      <mp-overlay-dialog-trigger>
                                        <i class="fa fa-info-circle" style="color: #17a2b8; cursor: pointer; margin-left: 5px; font-size: 14px;"></i>
                                      </mp-overlay-dialog-trigger>
                                      <mp-overlay-dialog-content>
                                        <div style="padding: 20px; background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%); border-radius: 8px;">
                                          <h5 style="color: #2c3e50; margin-bottom: 20px; padding-bottom: 10px; border-bottom: 2px solid #3498db;">
                                            <i class="fa fa-desktop" style="color: #3498db; margin-right: 8px;"></i>
                                            Original Medium Information
                                          </h5>
                                          <div style="background: white; padding: 15px; border-radius: 6px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                                            <div style="margin-bottom: 12px; display: flex; align-items: start;">
                                              <i class="fa fa-desktop" style="color: #9b59b6; margin-right: 10px; margin-top: 3px;"></i>
                                              <div>
                                                <strong style="color: #555; display: block; margin-bottom: 2px;">System</strong>
                                                <span style="color: #333;">Western Digital WDBACW0020HBK-01 My Book 2TB USB 3.0 Series External Hard Drive</span>
                                              </div>
                                            </div>
                                            <div style="display: flex; align-items: start;">
                                              <i class="fa fa-file-text-o" style="color: #e74c3c; margin-right: 10px; margin-top: 3px;"></i>
                                              <div>
                                                <strong style="color: #555; display: block; margin-bottom: 2px;">Notes</strong>
                                                <span style="color: #333;">Original backup device.</span>
                                              </div>
                                            </div>
                                          </div>
                                        </div>
                                      </mp-overlay-dialog-content>
                                    </mp-overlay-dialog>
                                  </td>
                                </tr>
                              {{else if (eq ../iri "http://ficlit.unibo.it/ArchivioEvangelisti/structure/RS1_RS3")}}
                                <tr>
                                  <td>Items Count</td>
                                  <td>117 floppy disks containing 891 items</td>
                                </tr>
                                <tr>
                                  <td>Contents Date Range</td>
                                  <td>[insert]</td>
                                </tr>
                                <tr>
                                  <td>Total Size</td>
                                  <td>4,85 GB</td>
                                </tr>
                                <tr>
                                  <td>Current Medium</td>
                                  <td>
                                    Server Dell PowerEdge R7525
                                    <mp-overlay-dialog title="Current Medium Derivation Info" type="modal" bs-size="medium">
                                      <mp-overlay-dialog-trigger>
                                        <i class="fa fa-info-circle" style="color: #17a2b8; cursor: pointer; margin-left: 5px; font-size: 14px;"></i>
                                      </mp-overlay-dialog-trigger>
                                      <mp-overlay-dialog-content>
                                        <div style="padding: 20px; background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%); border-radius: 8px;">
                                          <h5 style="color: #2c3e50; margin-bottom: 20px; padding-bottom: 10px; border-bottom: 2px solid #3498db;">
                                            <i class="fa fa-calendar" style="color: #3498db; margin-right: 8px;"></i>
                                            Derivation Information
                                          </h5>
                                          <div style="background: white; padding: 15px; border-radius: 6px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                                            <div style="margin-bottom: 12px; display: flex; align-items: start;">
                                              <i class="fa fa-calendar-check-o" style="color: #3498db; margin-right: 10px; margin-top: 3px;"></i>
                                              <div>
                                                <strong style="color: #555; display: block; margin-bottom: 2px;">Transfer Date</strong>
                                                <span style="color: #333;">2025-08-06</span>
                                              </div>
                                            </div>
                                            <div style="margin-bottom: 12px; display: flex; align-items: start;">
                                              <i class="fa fa-arrow-right" style="color: #27ae60; margin-right: 10px; margin-top: 3px;"></i>
                                              <div>
                                                <strong style="color: #555; display: block; margin-bottom: 2px;">From</strong>
                                                <span style="color: #333;">Samsung Portable SSD T7 (macro folder with all floppy disk migrations)</span>
                                              </div>
                                            </div>
                                            <div style="margin-bottom: 12px; display: flex; align-items: start;">
                                              <i class="fa fa-user" style="color: #f39c12; margin-right: 10px; margin-top: 3px;"></i>
                                              <div>
                                                <strong style="color: #555; display: block; margin-bottom: 2px;">Performed By</strong>
                                                <span style="color: #333;">Associazione Valerio Evangelisti - Il Sol dell'Avvenire</span>
                                              </div>
                                            </div>
                                            <div style="display: flex; align-items: start;">
                                              <i class="fa fa-file-text-o" style="color: #9b59b6; margin-right: 10px; margin-top: 3px;"></i>
                                              <div>
                                                <strong style="color: #555; display: block; margin-bottom: 2px;">Notes</strong>
                                                <span style="color: #333;">Migrated to Server Dell PowerEdge R7525 to perform structure and metadata extraction</span>
                                              </div>
                                            </div>
                                          </div>
                                        </div>
                                      </mp-overlay-dialog-content>
                                    </mp-overlay-dialog>
                                  </td>
                                </tr>
                                
                                <tr>
                                  <td>Previous Medium</td>
                                  <td>
                                    Samsung Portable SSD T7 1 TB USB tipo-C 3.2 Gen 2
                                    <mp-overlay-dialog title="Previous Medium Derivation Info" type="modal" bs-size="medium">
                                      <mp-overlay-dialog-trigger>
                                        <i class="fa fa-info-circle" style="color: #17a2b8; cursor: pointer; margin-left: 5px; font-size: 14px;"></i>
                                      </mp-overlay-dialog-trigger>
                                      <mp-overlay-dialog-content>
                                        <div style="padding: 20px; background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%); border-radius: 8px;">
                                          <h5 style="color: #2c3e50; margin-bottom: 20px; padding-bottom: 10px; border-bottom: 2px solid #3498db;">
                                            <i class="fa fa-folder" style="color: #3498db; margin-right: 8px;"></i>
                                            Derivation Information
                                          </h5>
                                          <div style="background: white; padding: 15px; border-radius: 6px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                                            <div style="margin-bottom: 12px; display: flex; align-items: start;">
                                              <i class="fa fa-calendar-check-o" style="color: #3498db; margin-right: 10px; margin-top: 3px;"></i>
                                              <div>
                                                <strong style="color: #555; display: block; margin-bottom: 2px;">Transfer Date</strong>
                                                <span style="color: #333;">2024-2025</span>
                                              </div>
                                            </div>
                                            <div style="display: flex; align-items: start;">
                                              <i class="fa fa-arrow-right" style="color: #27ae60; margin-right: 10px; margin-top: 3px;"></i>
                                              <div>
                                                <strong style="color: #555; display: block; margin-bottom: 2px;">From</strong>
                                                <span style="color: #333;">Individual floppy disks</span>
                                              </div>
                                            </div>
                                            <div style="margin-bottom: 12px; display: flex; align-items: start;">
                                              <i class="fa fa-user" style="color: #f39c12; margin-right: 10px; margin-top: 3px;"></i>
                                              <div>
                                                <strong style="color: #555; display: block; margin-bottom: 2px;">Performed By</strong>
                                                <span style="color: #333;">Associazione Valerio Evangelisti - Il Sol dell'Avvenire</span>
                                              </div>
                                            </div>
                                            <div style="display: flex; align-items: start;">
                                              <i class="fa fa-file-text-o" style="color: #9b59b6; margin-right: 10px; margin-top: 3px;"></i>
                                              <div>
                                                <strong style="color: #555; display: block; margin-bottom: 2px;">Notes</strong>
                                                <span style="color: #333;">Macro folder created to organize all floppy disk migrations for further processing.</span>
                                              </div>
                                            </div>
                                          </div>
                                        </div>
                                      </mp-overlay-dialog-content>
                                    </mp-overlay-dialog>
                                  </td>
                                </tr>
                                
                                <tr>
                                  <td>Original Medium</td>
                                  <td>
                                    Individual floppy disks
                                    <mp-overlay-dialog title="Original Medium Info" type="modal" bs-size="medium">
                                      <mp-overlay-dialog-trigger>
                                        <i class="fa fa-info-circle" style="color: #17a2b8; cursor: pointer; margin-left: 5px; font-size: 14px;"></i>
                                      </mp-overlay-dialog-trigger>
                                      <mp-overlay-dialog-content>
                                        <div style="padding: 20px; background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%); border-radius: 8px;">
                                          <h5 style="color: #2c3e50; margin-bottom: 20px; padding-bottom: 10px; border-bottom: 2px solid #3498db;">
                                            <i class="fa fa-floppy-o" style="color: #3498db; margin-right: 8px;"></i>
                                            Original Medium Information
                                          </h5>
                                          <div style="background: white; padding: 15px; border-radius: 6px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                                            <div style="display: flex; align-items: start;">
                                              <i class="fa fa-file-text-o" style="color: #e74c3c; margin-right: 10px; margin-top: 3px;"></i>
                                              <div>
                                                <strong style="color: #555; display: block; margin-bottom: 2px;">Notes</strong>
                                                <span style="color: #333;">Each floppy disk represents an original creation medium; files were produced over multiple years. No single device exists at this level.</span>
                                              </div>
                                            </div>
                                          </div>
                                        </div>
                                      </mp-overlay-dialog-content>
                                    </mp-overlay-dialog>
                                  </td>
                                </tr>                              
                              {{/if}}
                            </tbody>
                          </table>
                        </div>
                      </div>
                      
                    {{else}}
                    
                    <!-- Record Metadata Section -->
                    <div class="metadata-section">
                      <h4>Record Metadata</h4>
                      
                      <div class="metadata-field">
                        <span class="metadata-label">Title:</span>
                        <span class="metadata-value">
                          {{#if titleLabel}}
                            {{titleLabel.value}}
                          {{else if title}}
                            {{title.value}}
                          {{else}}
                            <em>No title available</em>
                          {{/if}}
                        </span>
                      </div>
                      
                      <div class="metadata-field">
                        <span class="metadata-label">Creation Date:</span>
                        <span class="metadata-value">
                          {{#if creationDateLabel}}
                            {{creationDateLabel.value}}
                          {{else if creationDateNormalized}}
                            {{creationDateNormalized.value}}
                          {{else if creationDate}}
                            {{creationDate.value}}
                          {{else}}
                            <em>No creation date available</em>
                          {{/if}}
                        </span>
                      </div>
                      
                      <div class="metadata-field">
                        <span class="metadata-label">Modification Date:</span>
                        <span class="metadata-value">
                          {{#if modificationDateLabel}}
                            {{modificationDateLabel.value}}
                          {{else if modificationDateNormalized}}
                            {{modificationDateNormalized.value}}
                          {{else if modificationDate}}
                            {{modificationDate.value}}
                          {{else}}
                            <em>No modification date available</em>
                          {{/if}}
                        </span>
                      </div>
                    </div>
                    
                    <!-- Instantiation Metadata Section -->
                    {{#if instantiation}}
                      <div class="metadata-section">
                        <h4>Instantiation Metadata</h4>
                        
                        <div class="metadata-field">
                          <span class="metadata-label">File type:</span>
                          <span class="metadata-value">
                            {{#if instType}}
                              {{instType.value}}
                            {{else}}
                              <em>Not specified</em>
                            {{/if}}
                          </span>
                        </div>
                        
                        {{#if ../bindings}}
                          
                          <!-- Content Metadata -->
                          <div style="margin-top: 15px;">
                            <strong>Content Metadata</strong>
                            <table class="metadata-table">
                              <thead>
                                <tr>
                                  <th>Property</th>
                                  <th>Value</th>
                                  <th style="width: 30px;"></th>
                                </tr>
                              </thead>
                              <tbody>
                                {{#each ../bindings}}
                                  {{#if (and techMetadataLabel (or (eq metadataSetLabel.value "Document content metadata") (eq metadataSetLabel.value "Image metadata")))}}
                                    <tr>
                                      <td>{{techMetadataTypeLabel.value}}</td>
                                      <td>{{techMetadataValue.value}}</td>
                                      <td style="text-align: center;">
                                        <mp-overlay-dialog title="{{techMetadataTypeLabel.value}} Provenance" type="modal" bs-size="medium">
                                          <mp-overlay-dialog-trigger>
                                            <i class="fa fa-info-circle" style="color: #17a2b8; cursor: pointer; font-size: 14px;"></i>
                                          </mp-overlay-dialog-trigger>
                                          <mp-overlay-dialog-content>
                                            <div style="padding: 20px; background: linear-gradient(135deg, #f5eddc 0%, #e8dcc8 100%); border-radius: 8px;">
                                              <h5 style="color: #2c3e50; margin-bottom: 20px; padding-bottom: 10px; border-bottom: 2px solid #E86A33;">
                                                <i class="fa fa-info-circle" style="color: #3498db; margin-right: 8px;"></i>
                                                Provenance Information
                                              </h5>
                                              <div style="background: white; padding: 15px; border-radius: 6px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                                                <div style="margin-bottom: 12px; display: flex; align-items: start;">
                                                  <i class="fa fa-cogs" style="color: #e74c3c; margin-right: 10px; margin-top: 3px;"></i>
                                                  <div>
                                                    <strong style="color: #555; display: block; margin-bottom: 2px;">Activity</strong>
                                                    <span style="color: #333;">{{#if activityLabel}}{{activityLabel.value}}{{else}}Content analysis{{/if}}</span>
                                                  </div>
                                                </div>
                                                <div style="margin-bottom: 12px; display: flex; align-items: start;">
                                                  <i class="fa fa-server" style="color: #9b59b6; margin-right: 10px; margin-top: 3px;"></i>
                                                  <div>
                                                    <strong style="color: #555; display: block; margin-bottom: 2px;">Software Stack</strong>
                                                    <span style="color: #333;">{{#if softwareStackLabel}}{{softwareStackLabel.value}}{{else}}Apache Tika 2.9.1{{/if}}</span>
                                                  </div>
                                                </div>
                                                <div style="margin-bottom: 12px; display: flex; align-items: start;">
                                                  <i class="fa fa-calendar" style="color: #3498db; margin-right: 10px; margin-top: 3px;"></i>
                                                  <div>
                                                    <strong style="color: #555; display: block; margin-bottom: 2px;">Date</strong>
                                                    <span style="color: #333;">{{#if dateValue}}{{dateValue.value}}{{else}}2025-01-08{{/if}}</span>
                                                  </div>
                                                </div>
                                                <div style="margin-bottom: 12px; display: flex; align-items: start;">
                                                  <i class="fa fa-clock-o" style="color: #27ae60; margin-right: 10px; margin-top: 3px;"></i>
                                                  <div>
                                                    <strong style="color: #555; display: block; margin-bottom: 2px;">Processing Time</strong>
                                                    <span style="color: #333;">{{#if parsingTime}}{{parsingTime.value}}{{else}}0.125 seconds{{/if}}</span>
                                                  </div>
                                                </div>
                                                <div style="display: flex; align-items: start;">
                                                  <i class="fa fa-user" style="color: #f39c12; margin-right: 10px; margin-top: 3px;"></i>
                                                  <div>
                                                    <strong style="color: #555; display: block; margin-bottom: 2px;">Supervisor</strong>
                                                    <span style="color: #333;">{{#if activitySupervisor}}{{activitySupervisor.value}}{{else}}System Administrator{{/if}}</span>
                                                  </div>
                                                </div>
                                              </div>
                                            </div>
                                          </mp-overlay-dialog-content>
                                        </mp-overlay-dialog>
                                      </td>
                                    </tr>
                                  {{/if}}
                                {{/each}}
                              </tbody>
                            </table>
                          </div>
                          
                          <!-- File System Metadata -->
                          <div style="margin-top: 15px;">
                            <strong>File System Metadata</strong>
                            <table class="metadata-table">
                              <thead>
                                <tr>
                                  <th>Property</th>
                                  <th>Value</th>
                                  <th style="width: 30px;"></th>
                                </tr>
                              </thead>
                              <tbody>
                                {{#each ../bindings}}
                                  {{#if (and techMetadataLabel (eq metadataSetLabel.value "File system metadata"))}}
                                    <tr>
                                      <td>{{techMetadataTypeLabel.value}}</td>
                                      <td>{{techMetadataValue.value}}</td>
                                      <td style="text-align: center;">
                                        <mp-overlay-dialog title="{{techMetadataTypeLabel.value}} Provenance" type="modal" bs-size="medium">
                                          <mp-overlay-dialog-trigger>
                                            <i class="fa fa-info-circle" style="color: #17a2b8; cursor: pointer; font-size: 14px;"></i>
                                          </mp-overlay-dialog-trigger>
                                          <mp-overlay-dialog-content>
                                            <div style="padding: 20px; background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%); border-radius: 8px;">
                                              <h5 style="color: #2c3e50; margin-bottom: 20px; padding-bottom: 10px; border-bottom: 2px solid #E86A33;">
                                                <i class="fa fa-info-circle" style="color: #E86A33; margin-right: 8px;"></i>
                                                Provenance Information
                                              </h5>
                                              <div style="background: white; padding: 15px; border-radius: 6px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                                                <div style="margin-bottom: 12px; display: flex; align-items: start;">
                                                  <i class="fa fa-cogs" style="color: #e74c3c; margin-right: 10px; margin-top: 3px;"></i>
                                                  <div>
                                                    <strong style="color: #555; display: block; margin-bottom: 2px;">Activity</strong>
                                                    <span style="color: #333;">{{#if activityLabel}}{{activityLabel.value}}{{else}}Metadata extraction{{/if}}</span>
                                                  </div>
                                                </div>
                                                <div style="margin-bottom: 12px; display: flex; align-items: start;">
                                                  <i class="fa fa-server" style="color: #9b59b6; margin-right: 10px; margin-top: 3px;"></i>
                                                  <div>
                                                    <strong style="color: #555; display: block; margin-bottom: 2px;">Software Stack</strong>
                                                    <span style="color: #333;">{{#if softwareStackLabel}}{{softwareStackLabel.value}}{{else}}FileSystemAnalyzer v2.1{{/if}}</span>
                                                  </div>
                                                </div>
                                                <div style="margin-bottom: 12px; display: flex; align-items: start;">
                                                  <i class="fa fa-calendar" style="color: #3498db; margin-right: 10px; margin-top: 3px;"></i>
                                                  <div>
                                                    <strong style="color: #555; display: block; margin-bottom: 2px;">Date</strong>
                                                    <span style="color: #333;">{{#if dateValue}}{{dateValue.value}}{{else}}2025-01-08{{/if}}</span>
                                                  </div>
                                                </div>
                                                <div style="margin-bottom: 12px; display: flex; align-items: start;">
                                                  <i class="fa fa-clock-o" style="color: #27ae60; margin-right: 10px; margin-top: 3px;"></i>
                                                  <div>
                                                    <strong style="color: #555; display: block; margin-bottom: 2px;">Processing Time</strong>
                                                    <span style="color: #333;">{{#if parsingTime}}{{parsingTime.value}}{{else}}0.005 seconds{{/if}}</span>
                                                  </div>
                                                </div>
                                                <div style="display: flex; align-items: start;">
                                                  <i class="fa fa-user" style="color: #f39c12; margin-right: 10px; margin-top: 3px;"></i>
                                                  <div>
                                                    <strong style="color: #555; display: block; margin-bottom: 2px;">Supervisor</strong>
                                                    <span style="color: #333;">{{#if activitySupervisor}}{{activitySupervisor.value}}{{else}}Automated Process{{/if}}</span>
                                                  </div>
                                                </div>
                                              </div>
                                            </div>
                                          </mp-overlay-dialog-content>
                                        </mp-overlay-dialog>
                                      </td>
                                    </tr>
                                  {{/if}}
                                {{/each}}
                              </tbody>
                            </table>
                          </div>
                          
                          <!-- Other Technical Metadata -->
                          <div style="margin-top: 15px;">
                            <strong>Other Technical Metadata</strong>
                            <table class="metadata-table">
                              <thead>
                                <tr>
                                  <th>Category</th>
                                  <th>Property</th>
                                  <th>Value</th>
                                  <th style="width: 30px;"></th>
                                </tr>
                              </thead>
                              <tbody>
                                {{#each ../bindings}}
                                  {{#if (and techMetadataLabel (and (not (eq metadataSetLabel.value "File system metadata")) (and (not (eq metadataSetLabel.value "Document content metadata")) (not (eq metadataSetLabel.value "Image metadata")))))}}
                                    <tr>
                                      <td>{{#if metadataSetLabel}}{{metadataSetLabel.value}}{{else}}Other{{/if}}</td>
                                      <td>{{techMetadataTypeLabel.value}}</td>
                                      <td>{{techMetadataValue.value}}</td>
                                      <td style="text-align: center;">
                                        <mp-overlay-dialog title="{{techMetadataTypeLabel.value}} Provenance" type="modal" bs-size="medium">
                                          <mp-overlay-dialog-trigger>
                                            <i class="fa fa-info-circle" style="color: #17a2b8; cursor: pointer; font-size: 14px;"></i>
                                          </mp-overlay-dialog-trigger>
                                          <mp-overlay-dialog-content>
                                            <div style="padding: 20px; background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%); border-radius: 8px;">
                                              <h5 style="color: #2c3e50; margin-bottom: 20px; padding-bottom: 10px; border-bottom: 2px solid #3498db;">
                                                <i class="fa fa-info-circle" style="color: #3498db; margin-right: 8px;"></i>
                                                Provenance Information
                                              </h5>
                                              <div style="background: white; padding: 15px; border-radius: 6px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                                                <div style="margin-bottom: 12px; display: flex; align-items: start;">
                                                  <i class="fa fa-cogs" style="color: #e74c3c; margin-right: 10px; margin-top: 3px;"></i>
                                                  <div>
                                                    <strong style="color: #555; display: block; margin-bottom: 2px;">Activity</strong>
                                                    <span style="color: #333;">{{#if activityLabel}}{{activityLabel.value}}{{else}}Metadata extraction{{/if}}</span>
                                                  </div>
                                                </div>
                                                <div style="margin-bottom: 12px; display: flex; align-items: start;">
                                                  <i class="fa fa-server" style="color: #9b59b6; margin-right: 10px; margin-top: 3px;"></i>
                                                  <div>
                                                    <strong style="color: #555; display: block; margin-bottom: 2px;">Software Stack</strong>
                                                    <span style="color: #333;">{{#if softwareStackLabel}}{{softwareStackLabel.value}}{{else}}ResearchSpace Analyzer{{/if}}</span>
                                                  </div>
                                                </div>
                                                <div style="margin-bottom: 12px; display: flex; align-items: start;">
                                                  <i class="fa fa-calendar" style="color: #3498db; margin-right: 10px; margin-top: 3px;"></i>
                                                  <div>
                                                    <strong style="color: #555; display: block; margin-bottom: 2px;">Date</strong>
                                                    <span style="color: #333;">{{#if dateValue}}{{dateValue.value}}{{else}}2025-01-08{{/if}}</span>
                                                  </div>
                                                </div>
                                                <div style="margin-bottom: 12px; display: flex; align-items: start;">
                                                  <i class="fa fa-clock-o" style="color: #27ae60; margin-right: 10px; margin-top: 3px;"></i>
                                                  <div>
                                                    <strong style="color: #555; display: block; margin-bottom: 2px;">Processing Time</strong>
                                                    <span style="color: #333;">{{#if parsingTime}}{{parsingTime.value}}{{else}}0.018 seconds{{/if}}</span>
                                                  </div>
                                                </div>
                                                <div style="display: flex; align-items: start;">
                                                  <i class="fa fa-user" style="color: #f39c12; margin-right: 10px; margin-top: 3px;"></i>
                                                  <div>
                                                    <strong style="color: #555; display: block; margin-bottom: 2px;">Supervisor</strong>
                                                    <span style="color: #333;">{{#if activitySupervisor}}{{activitySupervisor.value}}{{else}}System Administrator{{/if}}</span>
                                                  </div>
                                                </div>
                                              </div>
                                            </div>
                                          </mp-overlay-dialog-content>
                                        </mp-overlay-dialog>
                                      </td>
                                    </tr>
                                  {{/if}}
                                {{/each}}
                              </tbody>
                            </table>
                          </div>
                        {{/if}}
                      </div>
                    {{else}}
                      <div class="metadata-section">
                        <h4>Instantiation Metadata</h4>
                        <div class="no-metadata">
                          No instantiation metadata available for this record.
                        </div>
                      </div>
                    {{/if}}
                    {{/if}} 
                  {{/with}}
                {{else}}
                  <div class="loading-metadata">
                    <i class="fa fa-spinner fa-spin" style="font-size: 24px; color: #3498db;"></i>
                    <p>Loading metadata...</p>
                  </div>
                {{/if}}
              </template>
            </semantic-query>
          {{else}}
            <h3 style="color: #2c3e50; border-bottom: 2px solid #E86A33; padding-bottom: 8px; margin-bottom: 15px;">
              Node Metadata
            </h3>
            <div class="no-metadata">
              Click on a node in the tree to view its metadata.
            </div>
          {{/if}}
        </template>
      </mp-event-target-template-render>
      </div>
    </div>
  </div>
</div>

[[> stile ]]